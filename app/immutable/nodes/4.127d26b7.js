import{N as U,s as V,M as I,O as z,f as x,a as R,l as B,g as y,w as M,c as O,h as T,m as L,d as h,j as b,i as E,y as w,z as N,P as H,J,p as Q,Q as W,I as K}from"../chunks/scheduler.4ff403ce.js";import{S as j,i as G,b as S,d as P,m as k,a as A,t as C,e as F,f as X}from"../chunks/index.e99c29cb.js";import{B as Y,a as Z,A as ee,g as te}from"../chunks/navigation.16604d7a.js";import"../chunks/Indicator.svelte_svelte_type_style_lang.063c4f60.js";import{c as ae,a as se,A as ne,L as re,T as oe}from"../chunks/TextField.21ca9009.js";import{w as q}from"../chunks/singletons.2db2962d.js";const le=()=>{const r=ae({email:se().required("Email is required").email("Email is not valid")}),e=q({email:""}),a=q({}),t=q([]);return{store:{schema:r,model:e,errors:a,touched:t},actions:{reset:()=>{e.set({email:""})},destroy:()=>{console.log("destroy called")},validate:async d=>{a.set({});try{console.log("validate",d);const f=await r.validate({email:d},{abortEarly:!1});return console.log("success",f),Promise.resolve()}catch(f){throw console.log("failed",f),a.update(i=>(f.inner.forEach(l=>{i||(i={}),i[l.path]={path:l.path,message:l.message}}),i)),console.log("### errors",U(a)),Error("Validation failed")}}}}},ie=le();function ce(r){var d,f,i;let e,a,t,n;function m(o){r[9](o)}let p={type:"email",name:"email",label:"Username",placeholder:"Email",disabled:r[1],isInvalid:((d=r[2])==null?void 0:d.email)!==void 0,helperMessage:(i=(f=r[2])==null?void 0:f.email)==null?void 0:i.message,novalidate:!0,required:!0};return r[0].email!==void 0&&(p.value=r[0].email),a=new oe({props:p}),Q.push(()=>X(a,"value",m)),a.$on("input",r[7]),{c(){e=x("div"),S(a.$$.fragment),this.h()},l(o){e=y(o,"DIV",{class:!0});var l=T(e);P(a.$$.fragment,l),l.forEach(h),this.h()},h(){b(e,"class","space-y-2")},m(o,l){E(o,e,l),k(a,e,null),n=!0},p(o,l){var $,g,_;const c={};l&2&&(c.disabled=o[1]),l&4&&(c.isInvalid=(($=o[2])==null?void 0:$.email)!==void 0),l&4&&(c.helperMessage=(_=(g=o[2])==null?void 0:g.email)==null?void 0:_.message),!t&&l&1&&(t=!0,c.value=o[0].email,W(()=>t=!1)),a.$set(c)},i(o){n||(A(a.$$.fragment,o),n=!0)},o(o){C(a.$$.fragment,o),n=!1},d(o){o&&h(e),F(a)}}}function ue(r){let e;return{c(){e=B("Restore email password")},l(a){e=L(a,"Restore email password")},m(a,t){E(a,e,t)},d(a){a&&h(e)}}}function me(r){let e,a="Forgot Password",t,n,m,p,d,f,i,o="Sign up",l,c,$,g,_;return m=new re({props:{class:"space-y-2",$$slots:{default:[ce]},$$scope:{ctx:r}}}),c=new Y({props:{type:"button",class:"w-full",$$slots:{default:[ue]},$$scope:{ctx:r}}}),c.$on("click",r[8]),{c(){e=x("h1"),e.textContent=a,t=R(),n=x("form"),S(m.$$.fragment),p=R(),d=x("div"),f=B("Not registered? "),i=x("a"),i.textContent=o,l=R(),S(c.$$.fragment),this.h()},l(s){e=y(s,"H1",{class:!0,"data-svelte-h":!0}),M(e)!=="svelte-i2x120"&&(e.textContent=a),t=O(s),n=y(s,"FORM",{class:!0});var u=T(n);P(m.$$.fragment,u),p=O(u),d=y(u,"DIV",{class:!0});var v=T(d);f=L(v,"Not registered? "),i=y(v,"A",{href:!0,class:!0,"data-svelte-h":!0}),M(i)!=="svelte-xwhabj"&&(i.textContent=o),v.forEach(h),l=O(u),P(c.$$.fragment,u),u.forEach(h),this.h()},h(){b(e,"class","text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl dark:text-white"),b(i,"href","/auth/sign-up"),b(i,"class","text-primary-700 hover:underline dark:text-primary-500"),b(d,"class","text-sm font-medium text-gray-500 dark:text-gray-300"),b(n,"class","space-y-4 md:space-y-6"),n.noValidate=!0},m(s,u){E(s,e,u),E(s,t,u),E(s,n,u),k(m,n,null),w(n,p),w(n,d),w(d,f),w(d,i),w(n,l),k(c,n,null),$=!0,g||(_=[N(i,"click",r[6]),N(n,"submit",H(r[8]))],g=!0)},p(s,u){const v={};u&8199&&(v.$$scope={dirty:u,ctx:s}),m.$set(v);const D={};u&8192&&(D.$$scope={dirty:u,ctx:s}),c.$set(D)},i(s){$||(A(m.$$.fragment,s),A(c.$$.fragment,s),$=!0)},o(s){C(m.$$.fragment,s),C(c.$$.fragment,s),$=!1},d(s){s&&(h(e),h(t),h(n)),F(m),F(c),g=!1,J(_)}}}function de(r){let e,a;return e=new ne({props:{$$slots:{default:[me]},$$scope:{ctx:r}}}),{c(){S(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,n){k(e,t,n),a=!0},p(t,[n]){const m={};n&8199&&(m.$$scope={dirty:n,ctx:t}),e.$set(m)},i(t){a||(A(e.$$.fragment,t),a=!0)},o(t){C(e.$$.fragment,t),a=!1},d(t){F(e,t)}}}function fe(r,e,a){let t,n,m;const{actions:{triggerResetPassword:p},store:{loading:d}}=Z;I(r,d,s=>a(1,n=s));const{store:{model:f,errors:i},actions:{validate:o}}=ie;I(r,f,s=>a(0,t=s)),I(r,i,s=>a(2,m=s));let l=!1;const c=()=>{f.set({email:""}),l=!1},$=async()=>{if(!l)return;const{email:s}=t;await o(s)},g=async()=>{try{l=!0;const{email:s}=t;await o(s);const u=await p(s,`${ee.APP_BASE_URL}/auth/update-password`);u!=null&&u.success&&(c(),await te("/auth/sign-in"))}catch(s){console.log("submit failed",s)}};z(c);function _(s){r.$$.not_equal(t.email,s)&&(t.email=s,f.set(t))}return[t,n,m,d,f,i,c,$,g,_]}class pe extends j{constructor(e){super(),G(this,e,fe,de,V,{})}}function $e(r){let e,a;return e=new pe({}),{c(){S(e.$$.fragment)},l(t){P(e.$$.fragment,t)},m(t,n){k(e,t,n),a=!0},p:K,i(t){a||(A(e.$$.fragment,t),a=!0)},o(t){C(e.$$.fragment,t),a=!1},d(t){F(e,t)}}}class xe extends j{constructor(e){super(),G(this,e,null,$e,V,{})}}export{xe as component};
