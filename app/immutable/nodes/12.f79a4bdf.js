import{V as me,s as J,e as O,i as _,d as p,I as S,p as le,f as P,a as U,g as E,h as M,c as L,j as V,y as F,z as pe,W as $e,S as oe,l as K,m as x,w as Z,H as j,U as _e}from"../chunks/scheduler.eb33ae00.js";import{S as Q,i as X,a as g,g as ie,t as h,c as fe,h as ue,b as k,d as D,m as R,e as y}from"../chunks/index.3134e3af.js";import{S as be,r as ce,D as ge,a as he,b as we,c as ve}from"../chunks/types.a79c38c9.js";import{w as z}from"../chunks/index.70276595.js";import{a as ke}from"../chunks/auth.state.f6f5c1c1.js";import{n as De}from"../chunks/toaster.state.37fd4f23.js";import{C as Re,c as ye}from"../chunks/CloseButton.842d62f7.js";import{D as Ce}from"../chunks/Drawer.0a33e861.js";import{B as G}from"../chunks/Button.b81df063.js";import{f as Se,c as Ie,a as Te,T as Ne}from"../chunks/TextField.7d592578.js";let w=null;const Ae=()=>(w={drawerClosed:z(!0),focusedUser:z(null),closeDrawer:()=>{var n,e;w&&((e=(n=w==null?void 0:w.drawerClosed)==null?void 0:n.set)==null||e.call(n,!0))},openDrawer:()=>{var n,e;w&&((e=(n=w==null?void 0:w.drawerClosed)==null?void 0:n.set)==null||e.call(n,!1))}},w),Pe=()=>{w=null},ee=()=>w||Ae();class Ue extends be{constructor(){super("roles")}}const se=new Ue,{store:{currentUser:Ee}}=ke,{action:{toastify:Le}}=De,Ve={name:""},Be={name:""};let H=null;const Fe=()=>(H={loading:z(!1),model:z(Be),action:z("update"),targetRole:z(Ve),updateRole:async n=>{var e;try{const t=[{name:n.name,uuid:n.uuid,updated_by_id:(e=me(Ee))==null?void 0:e.id,updated_at:new Date().toISOString()}];await se.bulkUpdate(t,{onConflict:"uuid"}),Le({type:"success",message:"Updated role successfully"})}catch(t){console.log("update failed",t)}},deleteRole:async n=>{try{await se.bulkDelete([n])}catch(e){console.log("delete failed",e)}}},H),de=()=>H===null?Fe():H,qe=()=>{H=null};function re(n){var B,b,W;let e,t,a,l,o,s,f,r,i,c,$,T,N,A;function q(u){n[12](u)}let I={type:"text",name:"name",label:"Name",placeholder:"Name",disabled:n[1],isInvalid:((B=n[2])==null?void 0:B.name)!==void 0,helperMessage:(W=(b=n[2])==null?void 0:b.name)==null?void 0:W.message,novalidate:!0,required:!0};return n[0].name!==void 0&&(I.value=n[0].name),a=new Ne({props:I}),le.push(()=>ue(a,"value",q)),a.$on("input",n[10]),f=new G({props:{type:"submit",size:"xs",class:"mt-4 mb-4 w-full",disabled:n[1],$$slots:{default:[Me]},$$scope:{ctx:n}}}),i=new G({props:{type:"button",size:"xs",class:"mt-2 w-full",color:"alternative",disabled:n[1],$$slots:{default:[je]},$$scope:{ctx:n}}}),i.$on("click",n[8]),$=new G({props:{type:"button",size:"xs",class:"mt-2 w-full",color:"red",disabled:n[1],$$slots:{default:[He]},$$scope:{ctx:n}}}),$.$on("click",n[9]),{c(){e=P("form"),t=P("div"),k(a.$$.fragment),o=U(),s=P("div"),k(f.$$.fragment),r=U(),k(i.$$.fragment),c=U(),k($.$$.fragment),this.h()},l(u){e=E(u,"FORM",{class:!0});var m=M(e);t=E(m,"DIV",{class:!0});var C=M(t);D(a.$$.fragment,C),C.forEach(p),o=L(m),s=E(m,"DIV",{class:!0});var v=M(s);D(f.$$.fragment,v),r=L(v),D(i.$$.fragment,v),c=L(v),D($.$$.fragment,v),v.forEach(p),m.forEach(p),this.h()},h(){V(t,"class","mb-6"),V(s,"class","text-right"),e.noValidate=!0,V(e,"class","mb-6")},m(u,m){_(u,e,m),F(e,t),R(a,t,null),F(e,o),F(e,s),R(f,s,null),F(s,r),R(i,s,null),F(s,c),R($,s,null),T=!0,N||(A=pe(e,"submit",$e(n[11])),N=!0)},p(u,m){var te,ae,ne;const C={};m&2&&(C.disabled=u[1]),m&4&&(C.isInvalid=((te=u[2])==null?void 0:te.name)!==void 0),m&4&&(C.helperMessage=(ne=(ae=u[2])==null?void 0:ae.name)==null?void 0:ne.message),!l&&m&1&&(l=!0,C.value=u[0].name,oe(()=>l=!1)),a.$set(C);const v={};m&2&&(v.disabled=u[1]),m&2097154&&(v.$$scope={dirty:m,ctx:u}),f.$set(v);const d={};m&2&&(d.disabled=u[1]),m&2097152&&(d.$$scope={dirty:m,ctx:u}),i.$set(d);const Y={};m&2&&(Y.disabled=u[1]),m&2097152&&(Y.$$scope={dirty:m,ctx:u}),$.$set(Y)},i(u){T||(g(a.$$.fragment,u),g(f.$$.fragment,u),g(i.$$.fragment,u),g($.$$.fragment,u),T=!0)},o(u){h(a.$$.fragment,u),h(f.$$.fragment,u),h(i.$$.fragment,u),h($.$$.fragment,u),T=!1},d(u){u&&p(e),y(a),y(f),y(i),y($),N=!1,A()}}}function ze(n){let e;return{c(){e=K("Update")},l(t){e=x(t,"Update")},m(t,a){_(t,e,a)},d(t){t&&p(e)}}}function Oe(n){let e;return{c(){e=K("...")},l(t){e=x(t,"...")},m(t,a){_(t,e,a)},d(t){t&&p(e)}}}function Me(n){let e;function t(o,s){return o[1]?Oe:ze}let a=t(n),l=a(n);return{c(){l.c(),e=O()},l(o){l.l(o),e=O()},m(o,s){l.m(o,s),_(o,e,s)},p(o,s){a!==(a=t(o))&&(l.d(1),l=a(o),l&&(l.c(),l.m(e.parentNode,e)))},d(o){o&&p(e),l.d(o)}}}function je(n){let e;return{c(){e=K("Reset")},l(t){e=x(t,"Reset")},m(t,a){_(t,e,a)},d(t){t&&p(e)}}}function He(n){let e;return{c(){e=K("Delete")},l(t){e=x(t,"Delete")},m(t,a){_(t,e,a)},d(t){t&&p(e)}}}function Ke(n){let e,t,a=n[0]&&re(n);return{c(){a&&a.c(),e=O()},l(l){a&&a.l(l),e=O()},m(l,o){a&&a.m(l,o),_(l,e,o),t=!0},p(l,[o]){l[0]?a?(a.p(l,o),o&1&&g(a,1)):(a=re(l),a.c(),g(a,1),a.m(e.parentNode,e)):a&&(ie(),h(a,1,1,()=>{a=null}),fe())},i(l){t||(g(a),t=!0)},o(l){h(a),t=!1},d(l){l&&p(e),a&&a.d(l)}}}function xe(n,e,t){let a,l,o,s,f;const{loading:r,targetRole:i,model:c,updateRole:$,deleteRole:T}=de();S(n,r,d=>t(1,s=d)),S(n,i,d=>t(13,a=d)),S(n,c,d=>t(0,l=d));const{closeDrawer:N}=ee(),{store:{roles:A}}=ce,{errors:q,submitted:I,validate:B,reset:b}=Se(Ie({name:Te().required("Name is required").label("Name")}));S(n,q,d=>t(2,f=d)),S(n,I,d=>t(14,o=d));const W=()=>{a&&c.set({name:a.name}),I.set(!1),b()},u=async()=>{a!=null&&a.id&&(await T(a.id),await A.reload())},m=async()=>{if(!o)return;const{name:d}=l;await B({name:d})},C=async()=>{try{r.set(!0),I.set(!0);const{name:d}=l;await B({name:d}),await $({...a,name:d}),await A.reload(),N()}catch(d){console.log("submit failed",d)}finally{r.set(!1)}};i.subscribe(d=>{d&&c.set({name:d.name})});function v(d){n.$$.not_equal(l.name,d)&&(l.name=d,c.set(l))}return[l,s,f,r,i,c,q,I,W,u,m,C,v]}class We extends Q{constructor(e){super(),X(this,e,xe,Ke,J,{})}}function Ge(n){let e,t,a="User",l,o,s,f,r;return o=new Re({props:{class:"mb-4 dark:text-white"}}),o.$on("click",n[3]),f=new We({}),{c(){e=P("div"),t=P("h5"),t.textContent=a,l=U(),k(o.$$.fragment),s=U(),k(f.$$.fragment),this.h()},l(i){e=E(i,"DIV",{class:!0});var c=M(e);t=E(c,"H5",{id:!0,class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-tpi0tj"&&(t.textContent=a),l=L(c),D(o.$$.fragment,c),c.forEach(p),s=L(i),D(f.$$.fragment,i),this.h()},h(){V(t,"id","drawer-label"),V(t,"class","inline-flex items-center mb-6 text-base font-semibold text-gray-500 uppercase dark:text-gray-400"),V(e,"class","flex items-center")},m(i,c){_(i,e,c),F(e,t),F(e,l),R(o,e,null),_(i,s,c),R(f,i,c),r=!0},p:j,i(i){r||(g(o.$$.fragment,i),g(f.$$.fragment,i),r=!0)},o(i){h(o.$$.fragment,i),h(f.$$.fragment,i),r=!1},d(i){i&&(p(e),p(s)),y(o),y(f,i)}}}function Je(n){let e,t,a;function l(s){n[4](s)}let o={transitionType:"fly",transitionParams:n[1],id:"sidebar4",placement:"right",$$slots:{default:[Ge]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.hidden=n[0]),e=new Ce({props:o}),le.push(()=>ue(e,"hidden",l)),{c(){k(e.$$.fragment)},l(s){D(e.$$.fragment,s)},m(s,f){R(e,s,f),a=!0},p(s,[f]){const r={};f&32&&(r.$$scope={dirty:f,ctx:s}),!t&&f&1&&(t=!0,r.hidden=s[0],oe(()=>t=!1)),e.$set(r)},i(s){a||(g(e.$$.fragment,s),a=!0)},o(s){h(e.$$.fragment,s),a=!1},d(s){y(e,s)}}}function Qe(n,e,t){let a,l={x:320,duration:200,easing:ye};const{drawerClosed:o,closeDrawer:s}=ee();S(n,o,r=>t(0,a=r));function f(r){a=r,o.set(a)}return[a,l,o,s,f]}class Xe extends Q{constructor(e){super(),X(this,e,Qe,Je,J,{})}}function Ye(n){let e,t="No data";return{c(){e=P("p"),e.textContent=t},l(a){e=E(a,"P",{"data-svelte-h":!0}),Z(e)!=="svelte-t5me1l"&&(e.textContent=t)},m(a,l){_(a,e,l)},p:j,i:j,o:j,d(a){a&&p(e)}}}function Ze(n){let e,t,a,l,o,s,f;return t=new G({props:{color:"green",size:"xs",$$slots:{default:[et]},$$scope:{ctx:n}}}),t.$on("click",n[8]),l=new we({props:{options:n[0],data:n[2],loading:n[3]}}),s=new Xe({}),{c(){e=P("div"),k(t.$$.fragment),a=U(),k(l.$$.fragment),o=U(),k(s.$$.fragment),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=M(e);D(t.$$.fragment,i),i.forEach(p),a=L(r),D(l.$$.fragment,r),o=L(r),D(s.$$.fragment,r),this.h()},h(){V(e,"class","w-full flex justify-end mb-4")},m(r,i){_(r,e,i),R(t,e,null),_(r,a,i),R(l,r,i),_(r,o,i),R(s,r,i),f=!0},p(r,i){const c={};i&32768&&(c.$$scope={dirty:i,ctx:r}),t.$set(c);const $={};i&1&&($.options=r[0]),i&4&&($.data=r[2]),i&8&&($.loading=r[3]),l.$set($)},i(r){f||(g(t.$$.fragment,r),g(l.$$.fragment,r),g(s.$$.fragment,r),f=!0)},o(r){h(t.$$.fragment,r),h(l.$$.fragment,r),h(s.$$.fragment,r),f=!1},d(r){r&&(p(e),p(a),p(o)),y(t),y(l,r),y(s,r)}}}function et(n){let e;return{c(){e=K("+")},l(t){e=x(t,"+")},m(t,a){_(t,e,a)},d(t){t&&p(e)}}}function tt(n){let e,t,a,l;const o=[Ze,Ye],s=[];function f(r,i){return r[0]&&r[1]&&r[1].length>0?0:1}return e=f(n),t=s[e]=o[e](n),{c(){t.c(),a=O()},l(r){t.l(r),a=O()},m(r,i){s[e].m(r,i),_(r,a,i),l=!0},p(r,[i]){let c=e;e=f(r),e===c?s[e].p(r,i):(ie(),h(s[c],1,1,()=>{s[c]=null}),fe(),t=s[e],t?t.p(r,i):(t=s[e]=o[e](r),t.c()),g(t,1),t.m(a.parentNode,a))},i(r){l||(g(t),l=!0)},o(r){h(t),l=!1},d(r){r&&p(a),s[e].d(r)}}}function at(n,e,t){let a,l,o,s;const{store:{roles:f}}=ce;S(n,f,b=>t(1,l=b));const{openDrawer:r}=ee(),{targetRole:i}=de(),{loading:c}=f;S(n,c,b=>t(3,s=b));const $={onRowClick:b=>{r(),i.set(b)},columnDefs:[{label:"Name",dataProperty:"name",dataType:ge.String,viewAlignment:he.Left}]},T=ve($),{store:{options:N,data:A},actions:{setRowData:q}}=T;S(n,N,b=>t(0,a=b)),S(n,A,b=>t(2,o=b));const I=()=>{r()},B=f.subscribe(b=>{q(b)});return _e(()=>{B(),Pe(),qe()}),[a,l,o,s,f,c,N,A,I]}class nt extends Q{constructor(e){super(),X(this,e,at,tt,J,{})}}function st(n){let e,t="Roles",a,l,o;return l=new nt({}),{c(){e=P("p"),e.textContent=t,a=U(),k(l.$$.fragment),this.h()},l(s){e=E(s,"P",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-4f94pi"&&(e.textContent=t),a=L(s),D(l.$$.fragment,s),this.h()},h(){V(e,"class","text-base dark:text-white")},m(s,f){_(s,e,f),_(s,a,f),R(l,s,f),o=!0},p:j,i(s){o||(g(l.$$.fragment,s),o=!0)},o(s){h(l.$$.fragment,s),o=!1},d(s){s&&(p(e),p(a)),y(l,s)}}}class $t extends Q{constructor(e){super(),X(this,e,null,st,J,{})}}export{$t as component};
