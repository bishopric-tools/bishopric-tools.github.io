import{s as ee,u as W,f as S,e as P,g as R,h as L,d as b,x as je,P as ut,i as w,y as D,V as He,W as ke,z as _e,H as x,R as ft,L as dt,D as de,E as ye,l as G,m as j,X as Le,n as ie,r as ct,A as mt,B as _t,C as gt,O as H,Y as bt,Z as Ee,p as ae,a as V,c as z,S as se,j as K,I as F,_ as pt,w as st,U as ht}from"../chunks/scheduler.e91d0d47.js";import{S as te,i as le,a as y,g as Ce,t as C,c as De,h as re,b as E,d as $,m as N,e as T}from"../chunks/index.7198988d.js";import{B as we}from"../chunks/Button.ebceed54.js";import{d as $e,r as Ie,D as Ne,a as Te,b as vt,c as kt}from"../chunks/DataTable.dd057a7d.js";import{w as fe}from"../chunks/index.d0c06b92.js";import{a as yt}from"../chunks/auth.state.3a7674b6.js";import{n as wt}from"../chunks/toaster.state.b7593f34.js";import{C as Ct,c as Dt}from"../chunks/CloseButton.561265bd.js";import{D as It}from"../chunks/Drawer.9c696fd0.js";import{L as rt,I as St,f as Rt,c as Et,a as $t,b as Nt,T as Tt}from"../chunks/TextField.1e282ea7.js";import{g as Ae,t as Lt,a as it}from"../chunks/tw-merge.dd2125e8.js";import{e as Ke}from"../chunks/each.e59479a4.js";function We(n,e,l){const t=n.slice();return t[0]=e[l].value,t[17]=e[l].name,t}function Xe(n){let e,l;return{c(){e=S("option"),l=G(n[2]),this.h()},l(t){e=R(t,"OPTION",{});var a=L(e);l=j(a,n[2]),a.forEach(b),this.h()},h(){e.disabled=!0,e.selected=!0,e.__value="",Le(e,e.__value)},m(t,a){w(t,e,a),D(e,l)},p(t,a){a&4&&ie(l,t[2])},d(t){t&&b(e)}}}function Ye(n){let e;const l=n[10].default,t=ct(l,n,n[9],null);return{c(){t&&t.c()},l(a){t&&t.l(a)},m(a,s){t&&t.m(a,s),e=!0},p(a,s){t&&t.p&&(!e||s&512)&&mt(t,l,a,a[9],e?gt(l,a[9],s,null):_t(a[9]),null)},i(a){e||(y(t,a),e=!0)},o(a){C(t,a),e=!1},d(a){t&&t.d(a)}}}function Ze(n){let e,l=n[17]+"",t,a;return{c(){e=S("option"),t=G(l),this.h()},l(s){e=R(s,"OPTION",{});var r=L(e);t=j(r,l),r.forEach(b),this.h()},h(){e.__value=a=n[0],Le(e,e.__value)},m(s,r){w(s,e,r),D(e,t)},p(s,r){r&2&&l!==(l=s[17]+"")&&ie(t,l),r&2&&a!==(a=s[0])&&(e.__value=a,Le(e,e.__value))},d(s){s&&b(e)}}}function At(n){let e,l,t,a,s=n[2]&&Xe(n),r=Ke(n[1]),u=[];for(let i=0;i<r.length;i+=1)u[i]=Ze(We(n,r,i));let o=null;r.length||(o=Ye(n));let f=[n[4],{class:n[3]}],c={};for(let i=0;i<f.length;i+=1)c=W(c,f[i]);return{c(){e=S("select"),s&&s.c(),l=P();for(let i=0;i<u.length;i+=1)u[i].c();o&&o.c(),this.h()},l(i){e=R(i,"SELECT",{class:!0});var d=L(e);s&&s.l(d),l=P();for(let _=0;_<u.length;_+=1)u[_].l(d);o&&o.l(d),d.forEach(b),this.h()},h(){je(e,c),n[0]===void 0&&ut(()=>n[14].call(e))},m(i,d){w(i,e,d),s&&s.m(e,null),D(e,l);for(let _=0;_<u.length;_+=1)u[_]&&u[_].m(e,null);o&&o.m(e,null),"value"in c&&(c.multiple?He:ke)(e,c.value),e.autofocus&&e.focus(),ke(e,n[0],!0),t||(a=[_e(e,"change",n[14]),_e(e,"change",n[11]),_e(e,"contextmenu",n[12]),_e(e,"input",n[13])],t=!0)},p(i,[d]){if(i[2]?s?s.p(i,d):(s=Xe(i),s.c(),s.m(e,l)):s&&(s.d(1),s=null),d&514){r=Ke(i[1]);let _;for(_=0;_<r.length;_+=1){const v=We(i,r,_);u[_]?u[_].p(v,d):(u[_]=Ze(v),u[_].c(),u[_].m(e,null))}for(;_<u.length;_+=1)u[_].d(1);u.length=r.length,!r.length&&o?o.p(i,d):r.length?o&&(Ce(),C(o,1,1,()=>{o=null}),De()):(o=Ye(i),o.c(),y(o,1),o.m(e,null))}je(e,c=Ae(f,[d&16&&i[4],{class:i[3]}])),d&24&&"value"in c&&(c.multiple?He:ke)(e,c.value),d&3&&ke(e,i[0])},i:x,o:x,d(i){i&&b(e),s&&s.d(),ft(u,i),o&&o.d(),t=!1,dt(a)}}}const Pt="block w-full";function Mt(n,e,l){const t=["items","value","placeholder","underline","size","defaultClass","underlineClass"];let a=de(e,t),{$$slots:s={},$$scope:r}=e,{items:u=[]}=e,{value:o=void 0}=e,{placeholder:f="Choose option ..."}=e,{underline:c=!1}=e,{size:i="md"}=e,{defaultClass:d="text-gray-900 bg-gray-50 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"}=e,{underlineClass:_="text-gray-500 bg-transparent border-0 border-b-2 border-gray-200 appearance-none dark:text-gray-400 dark:border-gray-700 focus:outline-none focus:ring-0 focus:border-gray-200 peer"}=e;const v={sm:"text-sm p-2",md:"text-sm p-2.5",lg:"text-base py-3 px-4"};let I;function O(g){H.call(this,n,g)}function A(g){H.call(this,n,g)}function p(g){H.call(this,n,g)}function U(){o=bt(this),l(0,o),l(1,u)}return n.$$set=g=>{l(16,e=W(W({},e),ye(g))),l(4,a=de(e,t)),"items"in g&&l(1,u=g.items),"value"in g&&l(0,o=g.value),"placeholder"in g&&l(2,f=g.placeholder),"underline"in g&&l(5,c=g.underline),"size"in g&&l(6,i=g.size),"defaultClass"in g&&l(7,d=g.defaultClass),"underlineClass"in g&&l(8,_=g.underlineClass),"$$scope"in g&&l(9,r=g.$$scope)},n.$$.update=()=>{l(3,I=Lt(Pt,c?_:d,v[i],c&&"!px-0",e.class))},e=ye(e),[o,u,f,I,a,c,i,d,_,r,s,O,A,p,U]}class Vt extends te{constructor(e){super(),le(this,e,Mt,At,ee,{items:1,value:0,placeholder:2,underline:5,size:6,defaultClass:7,underlineClass:8})}}let M=null;const zt=()=>(M={drawerClosed:fe(!0),focusedUser:fe(null),closeDrawer:()=>{var n,e;M&&((e=(n=M==null?void 0:M.drawerClosed)==null?void 0:n.set)==null||e.call(n,!0))},openDrawer:()=>{var n,e;M&&((e=(n=M==null?void 0:M.drawerClosed)==null?void 0:n.set)==null||e.call(n,!1))}},M),Ot=()=>{M=null},Pe=()=>M||zt(),{store:{currentUser:Je}}=yt,{store:{roles:Ut}}=Ie,{action:{toastify:ue}}=wt,qt={name:"",sort_index:0,role_group_id:0},Ft={name:"",sort_index:0,group_id:"0"};let B=null;const Bt=()=>(B={loading:fe(!1),model:fe(Ft),action:fe("view"),targetRole:fe(qt),addRole:async n=>{var e,l,t,a;try{let s=n.sort_index;n.sort_index||(s=(((e=Ee(Ut).sort((o,f)=>!(f!=null&&f.sort_index)||!(o!=null&&o.sort_index)?0:f.sort_index-o.sort_index)[1])==null?void 0:e.sort_index)??0)+1);const r=[{name:n.name,sort_index:s,role_group_id:n.role_group_id,created_by_id:(l=Ee(Je))==null?void 0:l.id,created_at:new Date().toISOString()}];await $e.bulkCreate(r),(a=(t=B==null?void 0:B.targetRole)==null?void 0:t.set)==null||a.call(t,null),ue({type:"success",message:"Updated role successfully"})}catch{ue({type:"error",message:"Update role failed, please refresh browser and try again."})}},updateRole:async n=>{var e,l,t;try{const a=[{name:n.name,uuid:n.uuid,sort_index:n.sort_index,role_group_id:n.role_group_id,updated_by_id:(e=Ee(Je))==null?void 0:e.id,updated_at:new Date().toISOString()}];await $e.bulkUpdate(a,{onConflict:"uuid"}),(t=(l=B==null?void 0:B.targetRole)==null?void 0:l.set)==null||t.call(l,null),ue({type:"success",message:"Updated role successfully."})}catch{ue({type:"error",message:"Update role failed, please refresh browser and try again."})}},deleteRole:async n=>{if(n)try{await $e.bulkDelete([n]),ue({type:"success",message:"Deleted role successfully."})}catch{ue({type:"error",message:"Delete role failed, please refresh browser and try again."})}}},B),ot=()=>B===null?Bt():B,Gt=()=>{B=null};function Qe(n){let e,l;return{c(){e=S("small"),l=G(n[1])},l(t){e=R(t,"SMALL",{});var a=L(e);l=j(a,n[1]),a.forEach(b)},m(t,a){w(t,e,a),D(e,l)},p(t,a){a&2&&ie(l,t[1])},d(t){t&&b(e)}}}function jt(n){let e,l=n[1]&&Qe(n);return{c(){l&&l.c(),e=P()},l(t){l&&l.l(t),e=P()},m(t,a){l&&l.m(t,a),w(t,e,a)},p(t,a){t[1]?l?l.p(t,a):(l=Qe(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&b(e),l&&l.d(t)}}}function xe(n){let e,l;return{c(){e=S("div"),l=G(n[4]),this.h()},l(t){e=R(t,"DIV",{class:!0});var a=L(e);l=j(a,n[4]),a.forEach(b),this.h()},h(){K(e,"class",Kt)},m(t,a){w(t,e,a),D(e,l)},p(t,a){a&16&&ie(l,t[4])},d(t){t&&b(e)}}}function Ht(n){let e,l,t,a,s,r,u;e=new rt({props:{for:n[2],class:n[3]?`${n[5]} block mb-2`:"block mb-2",$$slots:{default:[jt]},$$scope:{ctx:n}}});const o=[n[6],{type:"number"},{class:n[3]?tt:et}];function f(d){n[7](d)}let c={};for(let d=0;d<o.length;d+=1)c=W(c,o[d]);n[0]!==void 0&&(c.value=n[0]),t=new St({props:c}),ae.push(()=>re(t,"value",f)),t.$on("click",n[8]),t.$on("blur",n[9]),t.$on("focus",n[10]),t.$on("input",n[11]),t.$on("keydown",n[12]),t.$on("keyup",n[13]);let i=n[4]&&xe(n);return{c(){E(e.$$.fragment),l=V(),E(t.$$.fragment),s=V(),i&&i.c(),r=P()},l(d){$(e.$$.fragment,d),l=z(d),$(t.$$.fragment,d),s=z(d),i&&i.l(d),r=P()},m(d,_){N(e,d,_),w(d,l,_),N(t,d,_),w(d,s,_),i&&i.m(d,_),w(d,r,_),u=!0},p(d,[_]){const v={};_&4&&(v.for=d[2]),_&8&&(v.class=d[3]?`${d[5]} block mb-2`:"block mb-2"),_&16386&&(v.$$scope={dirty:_,ctx:d}),e.$set(v);const I=_&72?Ae(o,[_&64&&it(d[6]),o[1],_&8&&{class:d[3]?tt:et}]):{};!a&&_&1&&(a=!0,I.value=d[0],se(()=>a=!1)),t.$set(I),d[4]?i?i.p(d,_):(i=xe(d),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},i(d){u||(y(e.$$.fragment,d),y(t.$$.fragment,d),u=!0)},o(d){C(e.$$.fragment,d),C(t.$$.fragment,d),u=!1},d(d){d&&(b(l),b(s),b(r)),T(e,d),T(t,d),i&&i.d(d)}}}const et="block w-full disabled:cursor-not-allowed disabled:opacity-50 p-2.5 focus:border-primary-500 focus:ring-primary-500 dark:focus:border-primary-500 dark:focus:ring-primary-500 bg-gray-50 text-gray-900 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 border-gray-300 dark:border-gray-600 text-sm rounded-lg",tt="block w-full disabled:cursor-not-allowed disabled:opacity-50 p-2.5 focus:ring-red-500 focus:border-red-500 dark:focus:ring-red-500 dark:focus:border-red-500 bg-red-50 text-red-900 placeholder-red-700 dark:text-red-500 dark:placeholder-red-500 dark:bg-gray-700 border-red-500 dark:border-red-400 text-sm rounded-lg",Kt="text-xs font-normal text-red-700 dark:text-red-500";function Wt(n,e,l){const t=["label","name","value","isInvalid","helperMessage"];let a=de(e,t),{label:s=""}=e,{name:r=""}=e,{value:u}=e,{isInvalid:o=!1}=e,{helperMessage:f}=e;const c="text-sm font-medium text-red-700 dark:text-red-500";function i(p){u=p,l(0,u)}function d(p){H.call(this,n,p)}function _(p){H.call(this,n,p)}function v(p){H.call(this,n,p)}function I(p){H.call(this,n,p)}function O(p){H.call(this,n,p)}function A(p){H.call(this,n,p)}return n.$$set=p=>{e=W(W({},e),ye(p)),l(6,a=de(e,t)),"label"in p&&l(1,s=p.label),"name"in p&&l(2,r=p.name),"value"in p&&l(0,u=p.value),"isInvalid"in p&&l(3,o=p.isInvalid),"helperMessage"in p&&l(4,f=p.helperMessage)},[u,s,r,o,f,c,a,i,d,_,v,I,O,A]}class Xt extends te{constructor(e){super(),le(this,e,Wt,Ht,ee,{label:1,name:2,value:0,isInvalid:3,helperMessage:4})}}function lt(n){let e,l;return{c(){e=S("small"),l=G(n[1])},l(t){e=R(t,"SMALL",{});var a=L(e);l=j(a,n[1]),a.forEach(b)},m(t,a){w(t,e,a),D(e,l)},p(t,a){a&2&&ie(l,t[1])},d(t){t&&b(e)}}}function Yt(n){let e,l=n[1]&&lt(n);return{c(){l&&l.c(),e=P()},l(t){l&&l.l(t),e=P()},m(t,a){l&&l.m(t,a),w(t,e,a)},p(t,a){t[1]?l?l.p(t,a):(l=lt(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&b(e),l&&l.d(t)}}}function Zt(n){let e,l,t,a,s;e=new rt({props:{for:n[2],class:"block mb-2",$$slots:{default:[Yt]},$$scope:{ctx:n}}});const r=[n[4],{items:n[3]}];function u(f){n[5](f)}let o={};for(let f=0;f<r.length;f+=1)o=W(o,r[f]);return n[0]!==void 0&&(o.value=n[0]),t=new Vt({props:o}),ae.push(()=>re(t,"value",u)),{c(){E(e.$$.fragment),l=V(),E(t.$$.fragment)},l(f){$(e.$$.fragment,f),l=z(f),$(t.$$.fragment,f)},m(f,c){N(e,f,c),w(f,l,c),N(t,f,c),s=!0},p(f,[c]){const i={};c&4&&(i.for=f[2]),c&66&&(i.$$scope={dirty:c,ctx:f}),e.$set(i);const d=c&24?Ae(r,[c&16&&it(f[4]),c&8&&{items:f[3]}]):{};!a&&c&1&&(a=!0,d.value=f[0],se(()=>a=!1)),t.$set(d)},i(f){s||(y(e.$$.fragment,f),y(t.$$.fragment,f),s=!0)},o(f){C(e.$$.fragment,f),C(t.$$.fragment,f),s=!1},d(f){f&&b(l),T(e,f),T(t,f)}}}function Jt(n,e,l){const t=["label","name","value","items"];let a=de(e,t),{label:s=""}=e,{name:r=""}=e,{value:u}=e,{items:o}=e;function f(c){u=c,l(0,u)}return n.$$set=c=>{e=W(W({},e),ye(c)),l(4,a=de(e,t)),"label"in c&&l(1,s=c.label),"name"in c&&l(2,r=c.name),"value"in c&&l(0,u=c.value),"items"in c&&l(3,o=c.items)},[u,s,r,o,a,f]}class Qt extends te{constructor(e){super(),le(this,e,Jt,Zt,ee,{label:1,name:2,value:0,items:3})}}function xt(n){let e,l,t;function a(r){n[6](r)}let s={label:n[1],name:n[2],items:n[3]};return n[0]!==void 0&&(s.value=n[0]),e=new Qt({props:s}),ae.push(()=>re(e,"value",a)),{c(){E(e.$$.fragment)},l(r){$(e.$$.fragment,r)},m(r,u){N(e,r,u),t=!0},p(r,[u]){const o={};u&2&&(o.label=r[1]),u&4&&(o.name=r[2]),u&8&&(o.items=r[3]),!l&&u&1&&(l=!0,o.value=r[0],se(()=>l=!1)),e.$set(o)},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){T(e,r)}}}function el(n,e,l){let t,a,{label:s=""}=e,{name:r=""}=e,{value:u}=e;const{store:{roleGroups:o}}=Ie;F(n,o,c=>l(5,a=c));function f(c){u=c,l(0,u)}return n.$$set=c=>{"label"in c&&l(1,s=c.label),"name"in c&&l(2,r=c.name),"value"in c&&l(0,u=c.value)},n.$$.update=()=>{n.$$.dirty&32&&l(3,t=a.map(c=>({value:c.id+"",name:`${c.name}`}))),n.$$.dirty&1&&console.log("### RoleGroupSelector > selected",u)},[u,s,r,t,o,a,f]}class tl extends te{constructor(e){super(),le(this,e,el,xt,ee,{label:1,name:2,value:0})}}function nt(n){var Y,ce,Me,Ve,ze,Oe;let e,l,t,a,s,r,u,o,f,c,i,d,_,v,I,O,A,p,U,g,q,X,ge;function be(h){n[14](h)}let pe={type:"text",name:"role-name",label:"Name",placeholder:"Name",disabled:n[2],isInvalid:((Y=n[3])==null?void 0:Y.name)!==void 0,helperMessage:(Me=(ce=n[3])==null?void 0:ce.name)==null?void 0:Me.message,novalidate:!0,required:!0};n[0].name!==void 0&&(pe.value=n[0].name),t=new Tt({props:pe}),ae.push(()=>re(t,"value",be)),t.$on("input",n[11]);function Se(h){n[15](h)}let he={name:"role-sort-index",label:"Sort Index",disabled:n[2],isInvalid:((Ve=n[3])==null?void 0:Ve.sort_index)!==void 0,helperMessage:(Oe=(ze=n[3])==null?void 0:ze.sort_index)==null?void 0:Oe.message,novalidate:!0,required:!0};n[0].sort_index!==void 0&&(he.value=n[0].sort_index),u=new Xt({props:he}),ae.push(()=>re(u,"value",Se)),u.$on("input",n[11]);function Re(h){n[16](h)}let ve={name:"role-group",label:"Role Group"};n[0].group_id!==void 0&&(ve.value=n[0].group_id),i=new tl({props:ve}),ae.push(()=>re(i,"value",Re));let m=n[1]!=="add"&&at(n);return p=new we({props:{type:"button",size:"xs",class:"mr-2",color:"alternative",disabled:n[2],$$slots:{default:[nl]},$$scope:{ctx:n}}}),p.$on("click",n[10]),g=new we({props:{type:"button",size:"xs",disabled:n[2],$$slots:{default:[rl]},$$scope:{ctx:n}}}),g.$on("click",n[12]),{c(){e=S("form"),l=S("div"),E(t.$$.fragment),s=V(),r=S("div"),E(u.$$.fragment),f=V(),c=S("div"),E(i.$$.fragment),_=V(),v=S("div"),I=S("div"),m&&m.c(),O=V(),A=S("div"),E(p.$$.fragment),U=V(),E(g.$$.fragment),this.h()},l(h){e=R(h,"FORM",{class:!0});var k=L(e);l=R(k,"DIV",{class:!0});var Z=L(l);$(t.$$.fragment,Z),Z.forEach(b),s=z(k),r=R(k,"DIV",{class:!0});var J=L(r);$(u.$$.fragment,J),J.forEach(b),f=z(k),c=R(k,"DIV",{});var me=L(c);$(i.$$.fragment,me),me.forEach(b),_=z(k),v=R(k,"DIV",{class:!0});var Q=L(v);I=R(Q,"DIV",{});var oe=L(I);m&&m.l(oe),oe.forEach(b),O=z(Q),A=R(Q,"DIV",{});var ne=L(A);$(p.$$.fragment,ne),U=z(ne),$(g.$$.fragment,ne),ne.forEach(b),Q.forEach(b),k.forEach(b),this.h()},h(){K(l,"class","mb-6"),K(r,"class","mb-6"),K(v,"class","flex justify-between mt-4"),e.noValidate=!0,K(e,"class","mb-6")},m(h,k){w(h,e,k),D(e,l),N(t,l,null),D(e,s),D(e,r),N(u,r,null),D(e,f),D(e,c),N(i,c,null),D(e,_),D(e,v),D(v,I),m&&m.m(I,null),D(v,O),D(v,A),N(p,A,null),D(A,U),N(g,A,null),q=!0,X||(ge=_e(e,"submit",pt(n[13])),X=!0)},p(h,k){var ne,Ue,qe,Fe,Be,Ge;const Z={};k&4&&(Z.disabled=h[2]),k&8&&(Z.isInvalid=((ne=h[3])==null?void 0:ne.name)!==void 0),k&8&&(Z.helperMessage=(qe=(Ue=h[3])==null?void 0:Ue.name)==null?void 0:qe.message),!a&&k&1&&(a=!0,Z.value=h[0].name,se(()=>a=!1)),t.$set(Z);const J={};k&4&&(J.disabled=h[2]),k&8&&(J.isInvalid=((Fe=h[3])==null?void 0:Fe.sort_index)!==void 0),k&8&&(J.helperMessage=(Ge=(Be=h[3])==null?void 0:Be.sort_index)==null?void 0:Ge.message),!o&&k&1&&(o=!0,J.value=h[0].sort_index,se(()=>o=!1)),u.$set(J);const me={};!d&&k&1&&(d=!0,me.value=h[0].group_id,se(()=>d=!1)),i.$set(me),h[1]!=="add"?m?(m.p(h,k),k&2&&y(m,1)):(m=at(h),m.c(),y(m,1),m.m(I,null)):m&&(Ce(),C(m,1,1,()=>{m=null}),De());const Q={};k&4&&(Q.disabled=h[2]),k&134217728&&(Q.$$scope={dirty:k,ctx:h}),p.$set(Q);const oe={};k&4&&(oe.disabled=h[2]),k&134217734&&(oe.$$scope={dirty:k,ctx:h}),g.$set(oe)},i(h){q||(y(t.$$.fragment,h),y(u.$$.fragment,h),y(i.$$.fragment,h),y(m),y(p.$$.fragment,h),y(g.$$.fragment,h),q=!0)},o(h){C(t.$$.fragment,h),C(u.$$.fragment,h),C(i.$$.fragment,h),C(m),C(p.$$.fragment,h),C(g.$$.fragment,h),q=!1},d(h){h&&b(e),T(t),T(u),T(i),m&&m.d(),T(p),T(g),X=!1,ge()}}}function at(n){let e,l;return e=new we({props:{type:"button",size:"xs",color:"red",disabled:n[2],$$slots:{default:[ll]},$$scope:{ctx:n}}}),e.$on("click",n[17]),{c(){E(e.$$.fragment)},l(t){$(e.$$.fragment,t)},m(t,a){N(e,t,a),l=!0},p(t,a){const s={};a&4&&(s.disabled=t[2]),a&134217728&&(s.$$scope={dirty:a,ctx:t}),e.$set(s)},i(t){l||(y(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){T(e,t)}}}function ll(n){let e;return{c(){e=G("Delete")},l(l){e=j(l,"Delete")},m(l,t){w(l,e,t)},d(l){l&&b(e)}}}function nl(n){let e;return{c(){e=G("Reset")},l(l){e=j(l,"Reset")},m(l,t){w(l,e,t)},d(l){l&&b(e)}}}function al(n){let e=n[1]==="add"?"Add":"Update",l;return{c(){l=G(e)},l(t){l=j(t,e)},m(t,a){w(t,l,a)},p(t,a){a&2&&e!==(e=t[1]==="add"?"Add":"Update")&&ie(l,e)},d(t){t&&b(l)}}}function sl(n){let e;return{c(){e=G("...")},l(l){e=j(l,"...")},m(l,t){w(l,e,t)},p:x,d(l){l&&b(e)}}}function rl(n){let e;function l(s,r){return s[2]?sl:al}let t=l(n),a=t(n);return{c(){a.c(),e=P()},l(s){a.l(s),e=P()},m(s,r){a.m(s,r),w(s,e,r)},p(s,r){t===(t=l(s))&&a?a.p(s,r):(a.d(1),a=t(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&b(e),a.d(s)}}}function il(n){let e,l,t=n[0]&&nt(n);return{c(){t&&t.c(),e=P()},l(a){t&&t.l(a),e=P()},m(a,s){t&&t.m(a,s),w(a,e,s),l=!0},p(a,[s]){a[0]?t?(t.p(a,s),s&1&&y(t,1)):(t=nt(a),t.c(),y(t,1),t.m(e.parentNode,e)):t&&(Ce(),C(t,1,1,()=>{t=null}),De())},i(a){l||(y(t),l=!0)},o(a){C(t),l=!1},d(a){a&&b(e),t&&t.d(a)}}}function ol(n,e,l){let t,a,s,r,u,o;const{loading:f,targetRole:c,model:i,action:d,addRole:_,updateRole:v,deleteRole:I}=ot();F(n,f,m=>l(2,u=m)),F(n,c,m=>l(18,a=m)),F(n,i,m=>l(0,t=m)),F(n,d,m=>l(1,s=m));const{closeDrawer:O}=Pe(),{store:{roles:A}}=Ie,{errors:p,submitted:U,validate:g,reset:q}=Rt(Et({name:$t().required("Name is required").label("Name"),sort_index:Nt().required().label("Sort Index")}));F(n,p,m=>l(3,o=m)),F(n,U,m=>l(19,r=m));const X=()=>{a&&i.set({name:a.name,sort_index:(a==null?void 0:a.sort_index)??0,group_id:`${a==null?void 0:a.role_group_id}`??"0"}),U.set(!1),q()},ge=async()=>{if(!r)return;const{name:m,sort_index:Y}=t;await g({name:m,sort_index:Y})},be=async()=>{try{f.set(!0),U.set(!0);const{name:m,sort_index:Y,group_id:ce}=t;switch(await g({name:m,sort_index:Y}),s){case"add":await _({...a,name:m,sort_index:Y,role_group_id:parseInt(ce,10)});break;case"update":await v({...a,name:m,sort_index:Y,role_group_id:parseInt(ce,10)});break;case"delete":a!=null&&a.id&&await I(a.id);break;default:}await A.reload(),O()}catch(m){console.log("submit failed",m)}finally{f.set(!1)}};c.subscribe(m=>{m&&(i.set({name:m==null?void 0:m.name,sort_index:(m==null?void 0:m.sort_index)??0,group_id:`${m==null?void 0:m.role_group_id}`??"0"}),console.log("### role",m))});function pe(m){H.call(this,n,m)}function Se(m){n.$$.not_equal(t.name,m)&&(t.name=m,i.set(t))}function he(m){n.$$.not_equal(t.sort_index,m)&&(t.sort_index=m,i.set(t))}function Re(m){n.$$.not_equal(t.group_id,m)&&(t.group_id=m,i.set(t))}const ve=()=>{d.set("delete"),be()};return n.$$.update=()=>{n.$$.dirty&1&&console.log("#### model",t)},[t,s,u,o,f,c,i,d,p,U,X,ge,be,pe,Se,he,Re,ve]}class ul extends te{constructor(e){super(),le(this,e,ol,il,ee,{})}}function fl(n){let e,l,t="User",a,s,r,u,o;return s=new Ct({props:{class:"mb-4 dark:text-white"}}),s.$on("click",n[3]),u=new ul({}),{c(){e=S("div"),l=S("h5"),l.textContent=t,a=V(),E(s.$$.fragment),r=V(),E(u.$$.fragment),this.h()},l(f){e=R(f,"DIV",{class:!0});var c=L(e);l=R(c,"H5",{id:!0,class:!0,"data-svelte-h":!0}),st(l)!=="svelte-tpi0tj"&&(l.textContent=t),a=z(c),$(s.$$.fragment,c),c.forEach(b),r=z(f),$(u.$$.fragment,f),this.h()},h(){K(l,"id","drawer-label"),K(l,"class","inline-flex items-center mb-6 text-base font-semibold text-gray-500 uppercase dark:text-gray-400"),K(e,"class","flex items-center")},m(f,c){w(f,e,c),D(e,l),D(e,a),N(s,e,null),w(f,r,c),N(u,f,c),o=!0},p:x,i(f){o||(y(s.$$.fragment,f),y(u.$$.fragment,f),o=!0)},o(f){C(s.$$.fragment,f),C(u.$$.fragment,f),o=!1},d(f){f&&(b(e),b(r)),T(s),T(u,f)}}}function dl(n){let e,l,t;function a(r){n[4](r)}let s={transitionType:"fly",transitionParams:n[1],id:"sidebar4",placement:"right",$$slots:{default:[fl]},$$scope:{ctx:n}};return n[0]!==void 0&&(s.hidden=n[0]),e=new It({props:s}),ae.push(()=>re(e,"hidden",a)),{c(){E(e.$$.fragment)},l(r){$(e.$$.fragment,r)},m(r,u){N(e,r,u),t=!0},p(r,[u]){const o={};u&32&&(o.$$scope={dirty:u,ctx:r}),!l&&u&1&&(l=!0,o.hidden=r[0],se(()=>l=!1)),e.$set(o)},i(r){t||(y(e.$$.fragment,r),t=!0)},o(r){C(e.$$.fragment,r),t=!1},d(r){T(e,r)}}}function cl(n,e,l){let t,a={x:320,duration:200,easing:Dt};const{drawerClosed:s,closeDrawer:r}=Pe();F(n,s,o=>l(0,t=o));function u(o){t=o,s.set(t)}return[t,a,s,r,u]}class ml extends te{constructor(e){super(),le(this,e,cl,dl,ee,{})}}function _l(n){let e,l="No data";return{c(){e=S("p"),e.textContent=l},l(t){e=R(t,"P",{"data-svelte-h":!0}),st(e)!=="svelte-t5me1l"&&(e.textContent=l)},m(t,a){w(t,e,a)},p:x,i:x,o:x,d(t){t&&b(e)}}}function gl(n){let e,l,t,a,s,r,u,o,f,c;return s=new we({props:{size:"xs",color:"alternative",$$slots:{default:[bl]},$$scope:{ctx:n}}}),s.$on("click",n[9]),u=new vt({props:{options:n[1],data:n[3],loading:n[4]}}),f=new ml({}),{c(){e=S("div"),l=S("p"),t=G(n[0]),a=V(),E(s.$$.fragment),r=V(),E(u.$$.fragment),o=V(),E(f.$$.fragment),this.h()},l(i){e=R(i,"DIV",{class:!0});var d=L(e);l=R(d,"P",{class:!0});var _=L(l);t=j(_,n[0]),_.forEach(b),a=z(d),$(s.$$.fragment,d),d.forEach(b),r=z(i),$(u.$$.fragment,i),o=z(i),$(f.$$.fragment,i),this.h()},h(){K(l,"class","text-base dark:text-white"),K(e,"class","flex justify-between mb-4 items-center")},m(i,d){w(i,e,d),D(e,l),D(l,t),D(e,a),N(s,e,null),w(i,r,d),N(u,i,d),w(i,o,d),N(f,i,d),c=!0},p(i,d){(!c||d&1)&&ie(t,i[0]);const _={};d&131072&&(_.$$scope={dirty:d,ctx:i}),s.$set(_);const v={};d&2&&(v.options=i[1]),d&8&&(v.data=i[3]),d&16&&(v.loading=i[4]),u.$set(v)},i(i){c||(y(s.$$.fragment,i),y(u.$$.fragment,i),y(f.$$.fragment,i),c=!0)},o(i){C(s.$$.fragment,i),C(u.$$.fragment,i),C(f.$$.fragment,i),c=!1},d(i){i&&(b(e),b(r),b(o)),T(s),T(u,i),T(f,i)}}}function bl(n){let e;return{c(){e=G("Add")},l(l){e=j(l,"Add")},m(l,t){w(l,e,t)},d(l){l&&b(e)}}}function pl(n){let e,l,t,a;const s=[gl,_l],r=[];function u(o,f){return o[1]&&o[2]&&o[2].length>0?0:1}return e=u(n),l=r[e]=s[e](n),{c(){l.c(),t=P()},l(o){l.l(o),t=P()},m(o,f){r[e].m(o,f),w(o,t,f),a=!0},p(o,[f]){let c=e;e=u(o),e===c?r[e].p(o,f):(Ce(),C(r[c],1,1,()=>{r[c]=null}),De(),l=r[e],l?l.p(o,f):(l=r[e]=s[e](o),l.c()),y(l,1),l.m(t.parentNode,t))},i(o){a||(y(l),a=!0)},o(o){C(l),a=!1},d(o){o&&b(t),r[e].d(o)}}}function hl(n,e,l){let t,a,s,r,{title:u="Roles"}=e;const{store:{roles:o}}=Ie;F(n,o,g=>l(2,a=g));const{openDrawer:f}=Pe(),{targetRole:c,action:i}=ot(),{loading:d}=o;F(n,d,g=>l(4,r=g));const _={onRowClick:g=>{i.set("update"),f();const q={...g},X={id:q.id,name:q.name,role_group_id:q.group_id,sort_index:q.sort_index,uuid:q.uuid};c.set(X),console.log("### onclick role",X)},columnDefs:[{label:"Name",dataProperty:"name",dataType:Ne.String,viewAlignment:Te.Left},{label:"Group",dataProperty:"group_name",dataType:Ne.String,viewAlignment:Te.Left},{label:"Sort Index",dataProperty:"sort_index",dataType:Ne.String,viewAlignment:Te.Right,width:32}]},v=kt(_),{store:{options:I,data:O},actions:{setRowData:A}}=v;F(n,I,g=>l(1,t=g)),F(n,O,g=>l(3,s=g));const p=()=>{i.set("add"),c.set({name:"",sort_index:0}),f()},U=o.subscribe(g=>{A(g)});return ht(()=>{U(),Ot(),Gt()}),n.$$set=g=>{"title"in g&&l(0,u=g.title)},[u,t,a,s,r,o,d,I,O,p]}class vl extends te{constructor(e){super(),le(this,e,hl,pl,ee,{title:0})}}function kl(n){let e,l;return e=new vl({}),{c(){E(e.$$.fragment)},l(t){$(e.$$.fragment,t)},m(t,a){N(e,t,a),l=!0},p:x,i(t){l||(y(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){T(e,t)}}}class Al extends te{constructor(e){super(),le(this,e,null,kl,ee,{})}}export{Al as component};
