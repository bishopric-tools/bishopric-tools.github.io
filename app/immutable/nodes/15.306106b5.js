import{s as V,p as Q,M as W,l as Z,m as ee,i as b,n as be,d as m,e as x,z as D,f as P,a as A,g as E,h as J,c as L,j as q,x as I,E as ge,a0 as he,C as le,y as M,a1 as ke}from"../chunks/scheduler.b53f554c.js";import{S as O,i as j,f as X,b as k,d as v,m as w,a as _,t as $,e as C,g as me,c as pe}from"../chunks/index.8dc6213e.js";import{D as se,a as re,b as ve,c as we}from"../chunks/DataTable.672f6284.js";import{d as Ce,r as _e}from"../chunks/rbac.state.8e8fb8aa.js";import{w as R}from"../chunks/index.adf7635c.js";import{C as De,c as Ue}from"../chunks/CloseButton.cc7e1be4.js";import{D as ye}from"../chunks/Drawer.beaec89c.js";import{B as ue}from"../chunks/Button.faff8da5.js";import{f as Se,c as Te,a as Ne,d as Ie,T as Pe}from"../chunks/TextField.422033c6.js";import{C as Ae}from"../chunks/Checkbox.99d5b40e.js";let h=null;const Ee=()=>(h={drawerClosed:R(!0),focusedUser:R(null),closeDrawer:()=>{var s,e;h&&((e=(s=h==null?void 0:h.drawerClosed)==null?void 0:s.set)==null||e.call(s,!0))},openDrawer:()=>{var s,e;h&&((e=(s=h==null?void 0:h.drawerClosed)==null?void 0:s.set)==null||e.call(s,!1))}},h),ie=()=>h||Ee(),Le={name:"",is_active:!1};let Y=null;const qe=()=>(Y={loading:R(!1),model:R(Le),targetUser:R(null),updateUser:async s=>{try{await Ce.bulkUpdate([s])}catch(e){console.log("submit failed",e)}}},Y),$e=()=>Y===null?qe():Y;function Fe(s){let e;return{c(){e=Z(s[1])},l(a){e=ee(a,s[1])},m(a,t){b(a,e,t)},p(a,t){t&2&&be(e,a[1])},d(a){a&&m(e)}}}function xe(s){let e,a,t;function l(n){s[2](n)}let r={$$slots:{default:[Fe]},$$scope:{ctx:s}};return s[0]!==void 0&&(r.checked=s[0]),e=new Ae({props:r}),Q.push(()=>X(e,"checked",l)),{c(){k(e.$$.fragment)},l(n){v(e.$$.fragment,n)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const c={};o&10&&(c.$$scope={dirty:o,ctx:n}),!a&&o&1&&(a=!0,c.checked=n[0],W(()=>a=!1)),e.$set(c)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Be(s,e,a){let{label:t=""}=e,{checked:l=!1}=e;function r(n){l=n,a(0,l)}return s.$$set=n=>{"label"in n&&a(1,t=n.label),"checked"in n&&a(0,l=n.checked)},[l,t,r]}class Me extends O{constructor(e){super(),j(this,e,Be,xe,V,{label:1,checked:0})}}function de(s){var H,K,G;let e,a,t,l,r,n,o,c,f,u,N,g,U,y,S;function F(i){s[11](i)}let p={type:"text",name:"name",label:"Name",placeholder:"Name",disabled:s[1],isInvalid:((H=s[2])==null?void 0:H.name)!==void 0,helperMessage:(G=(K=s[2])==null?void 0:K.name)==null?void 0:G.message,novalidate:!0,required:!0};s[0].name!==void 0&&(p.value=s[0].name),t=new Pe({props:p}),Q.push(()=>X(t,"value",F)),t.$on("input",s[9]);function te(i){s[12](i)}let z={label:"Is Active"};return s[0].is_active!==void 0&&(z.checked=s[0].is_active),o=new Me({props:z}),Q.push(()=>X(o,"checked",te)),u=new ue({props:{type:"button",class:"mr-3",color:"alternative",disabled:s[1],$$slots:{default:[Re]},$$scope:{ctx:s}}}),u.$on("click",s[8]),g=new ue({props:{type:"submit",class:"",disabled:s[1],$$slots:{default:[je]},$$scope:{ctx:s}}}),{c(){e=P("form"),a=P("div"),k(t.$$.fragment),r=A(),n=P("div"),k(o.$$.fragment),f=A(),k(u.$$.fragment),N=A(),k(g.$$.fragment),this.h()},l(i){e=E(i,"FORM",{class:!0});var d=J(e);a=E(d,"DIV",{class:!0});var T=J(a);v(t.$$.fragment,T),T.forEach(m),r=L(d),n=E(d,"DIV",{class:!0});var B=J(n);v(o.$$.fragment,B),B.forEach(m),f=L(d),v(u.$$.fragment,d),N=L(d),v(g.$$.fragment,d),d.forEach(m),this.h()},h(){q(a,"class","mb-6"),q(n,"class","mb-6"),e.noValidate=!0,q(e,"class","mb-6")},m(i,d){b(i,e,d),I(e,a),w(t,a,null),I(e,r),I(e,n),w(o,n,null),I(e,f),w(u,e,null),I(e,N),w(g,e,null),U=!0,y||(S=ge(e,"submit",he(s[10])),y=!0)},p(i,d){var oe,ce,fe;const T={};d&2&&(T.disabled=i[1]),d&4&&(T.isInvalid=((oe=i[2])==null?void 0:oe.name)!==void 0),d&4&&(T.helperMessage=(fe=(ce=i[2])==null?void 0:ce.name)==null?void 0:fe.message),!l&&d&1&&(l=!0,T.value=i[0].name,W(()=>l=!1)),t.$set(T);const B={};!c&&d&1&&(c=!0,B.checked=i[0].is_active,W(()=>c=!1)),o.$set(B);const ae={};d&2&&(ae.disabled=i[1]),d&1048576&&(ae.$$scope={dirty:d,ctx:i}),u.$set(ae);const ne={};d&2&&(ne.disabled=i[1]),d&1048578&&(ne.$$scope={dirty:d,ctx:i}),g.$set(ne)},i(i){U||(_(t.$$.fragment,i),_(o.$$.fragment,i),_(u.$$.fragment,i),_(g.$$.fragment,i),U=!0)},o(i){$(t.$$.fragment,i),$(o.$$.fragment,i),$(u.$$.fragment,i),$(g.$$.fragment,i),U=!1},d(i){i&&m(e),C(t),C(o),C(u),C(g),y=!1,S()}}}function Re(s){let e;return{c(){e=Z("Reset")},l(a){e=ee(a,"Reset")},m(a,t){b(a,e,t)},d(a){a&&m(e)}}}function Ve(s){let e;return{c(){e=Z("Update")},l(a){e=ee(a,"Update")},m(a,t){b(a,e,t)},d(a){a&&m(e)}}}function Oe(s){let e;return{c(){e=Z("...")},l(a){e=ee(a,"...")},m(a,t){b(a,e,t)},d(a){a&&m(e)}}}function je(s){let e;function a(r,n){return r[1]?Oe:Ve}let t=a(s),l=t(s);return{c(){l.c(),e=x()},l(r){l.l(r),e=x()},m(r,n){l.m(r,n),b(r,e,n)},p(r,n){t!==(t=a(r))&&(l.d(1),l=t(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){r&&m(e),l.d(r)}}}function ze(s){let e,a,t=s[0]&&de(s);return{c(){t&&t.c(),e=x()},l(l){t&&t.l(l),e=x()},m(l,r){t&&t.m(l,r),b(l,e,r),a=!0},p(l,[r]){l[0]?t?(t.p(l,r),r&1&&_(t,1)):(t=de(l),t.c(),_(t,1),t.m(e.parentNode,e)):t&&(me(),$(t,1,1,()=>{t=null}),pe())},i(l){a||(_(t),a=!0)},o(l){$(t),a=!1},d(l){l&&m(e),t&&t.d(l)}}}function He(s,e,a){let t,l,r,n,o;const{loading:c,targetUser:f,model:u,updateUser:N}=$e();D(s,c,i=>a(1,n=i)),D(s,f,i=>a(13,t=i)),D(s,u,i=>a(0,l=i));const{closeDrawer:g}=ie(),{store:{users:U}}=_e,{errors:y,submitted:S,validate:F,reset:p}=Se(Te({name:Ne().required("Name is required").label("Name"),is_active:Ie()}));D(s,y,i=>a(2,o=i)),D(s,S,i=>a(14,r=i));const te=()=>{t&&u.set({name:t.name,is_active:t.is_active}),S.set(!1),p()},z=async()=>{if(!r)return;const{name:i}=l;await F({name:i})},H=async()=>{try{c.set(!0),S.set(!0);const{name:i,is_active:d}=l;await F({name:i}),await N({...t,name:i,is_active:d}),await U.reload(),g()}catch(i){console.log("submit failed",i)}finally{c.set(!1)}};f.subscribe(i=>{i&&u.set({name:i.name,is_active:i.is_active})});function K(i){s.$$.not_equal(l.name,i)&&(l.name=i,u.set(l))}function G(i){s.$$.not_equal(l.is_active,i)&&(l.is_active=i,u.set(l))}return[l,n,o,c,f,u,y,S,te,z,H,K,G]}class Ke extends O{constructor(e){super(),j(this,e,He,ze,V,{})}}function Ge(s){let e,a,t="User",l,r,n,o,c;return r=new De({props:{class:"mb-4 dark:text-white"}}),r.$on("click",s[3]),o=new Ke({}),{c(){e=P("div"),a=P("h5"),a.textContent=t,l=A(),k(r.$$.fragment),n=A(),k(o.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=J(e);a=E(u,"H5",{id:!0,class:!0,"data-svelte-h":!0}),le(a)!=="svelte-tpi0tj"&&(a.textContent=t),l=L(u),v(r.$$.fragment,u),u.forEach(m),n=L(f),v(o.$$.fragment,f),this.h()},h(){q(a,"id","drawer-label"),q(a,"class","inline-flex items-center mb-6 text-base font-semibold text-gray-500 uppercase dark:text-gray-400"),q(e,"class","flex items-center")},m(f,u){b(f,e,u),I(e,a),I(e,l),w(r,e,null),b(f,n,u),w(o,f,u),c=!0},p:M,i(f){c||(_(r.$$.fragment,f),_(o.$$.fragment,f),c=!0)},o(f){$(r.$$.fragment,f),$(o.$$.fragment,f),c=!1},d(f){f&&(m(e),m(n)),C(r),C(o,f)}}}function Je(s){let e,a,t;function l(n){s[4](n)}let r={transitionType:"fly",transitionParams:s[1],id:"users-drawer",placement:"right",$$slots:{default:[Ge]},$$scope:{ctx:s}};return s[0]!==void 0&&(r.hidden=s[0]),e=new ye({props:r}),Q.push(()=>X(e,"hidden",l)),{c(){k(e.$$.fragment)},l(n){v(e.$$.fragment,n)},m(n,o){w(e,n,o),t=!0},p(n,[o]){const c={};o&32&&(c.$$scope={dirty:o,ctx:n}),!a&&o&1&&(a=!0,c.hidden=n[0],W(()=>a=!1)),e.$set(c)},i(n){t||(_(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Qe(s,e,a){let t,l={x:320,duration:200,easing:Ue};const{drawerClosed:r,closeDrawer:n}=ie();D(s,r,c=>a(0,t=c));function o(c){t=c,r.set(t)}return[t,l,r,n,o]}class We extends O{constructor(e){super(),j(this,e,Qe,Je,V,{})}}function Xe(s){let e,a="No data";return{c(){e=P("p"),e.textContent=a},l(t){e=E(t,"P",{"data-svelte-h":!0}),le(e)!=="svelte-t5me1l"&&(e.textContent=a)},m(t,l){b(t,e,l)},p:M,i:M,o:M,d(t){t&&m(e)}}}function Ye(s){let e,a,t,l;return e=new ve({props:{options:s[0],data:s[2],loading:s[3]}}),t=new We({}),{c(){k(e.$$.fragment),a=A(),k(t.$$.fragment)},l(r){v(e.$$.fragment,r),a=L(r),v(t.$$.fragment,r)},m(r,n){w(e,r,n),b(r,a,n),w(t,r,n),l=!0},p(r,n){const o={};n&1&&(o.options=r[0]),n&4&&(o.data=r[2]),n&8&&(o.loading=r[3]),e.$set(o)},i(r){l||(_(e.$$.fragment,r),_(t.$$.fragment,r),l=!0)},o(r){$(e.$$.fragment,r),$(t.$$.fragment,r),l=!1},d(r){r&&m(a),C(e,r),C(t,r)}}}function Ze(s){let e,a,t,l;const r=[Ye,Xe],n=[];function o(c,f){return c[0]&&c[1]&&c[1].length>0?0:1}return e=o(s),a=n[e]=r[e](s),{c(){a.c(),t=x()},l(c){a.l(c),t=x()},m(c,f){n[e].m(c,f),b(c,t,f),l=!0},p(c,[f]){let u=e;e=o(c),e===u?n[e].p(c,f):(me(),$(n[u],1,1,()=>{n[u]=null}),pe(),a=n[e],a?a.p(c,f):(a=n[e]=r[e](c),a.c()),_(a,1),a.m(t.parentNode,t))},i(c){l||(_(a),l=!0)},o(c){$(a),l=!1},d(c){c&&m(t),n[e].d(c)}}}function et(s,e,a){let t,l,r,n;const{store:{users:o}}=_e;D(s,o,p=>a(1,l=p));const{openDrawer:c}=ie(),{targetUser:f}=$e(),{loading:u}=o;D(s,u,p=>a(3,n=p));const N={sortable:!0,onRowClick:p=>{c(),f.set(p)},columnDefs:[{label:"Name",dataProperty:"name",dataType:se.String,viewAlignment:re.Left},{label:"Email",dataProperty:"email",dataType:se.String,viewAlignment:re.Left},{label:"Active",dataProperty:"is_active",dataType:se.String,viewAlignment:re.Left}]},g=we(N),{store:{options:U,data:y},actions:{setRowData:S}}=g;D(s,U,p=>a(0,t=p)),D(s,y,p=>a(2,r=p));const F=o.subscribe(p=>{S(p)});return ke(()=>{F()}),[t,l,r,n,o,u,U,y]}class tt extends O{constructor(e){super(),j(this,e,et,Ze,V,{})}}function at(s){let e,a="Users",t,l,r;return l=new tt({}),{c(){e=P("p"),e.textContent=a,t=A(),k(l.$$.fragment),this.h()},l(n){e=E(n,"P",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-7pkvs7"&&(e.textContent=a),t=L(n),v(l.$$.fragment,n),this.h()},h(){q(e,"class","text-base dark:text-white")},m(n,o){b(n,e,o),b(n,t,o),w(l,n,o),r=!0},p:M,i(n){r||(_(l.$$.fragment,n),r=!0)},o(n){$(l.$$.fragment,n),r=!1},d(n){n&&(m(e),m(t)),C(l,n)}}}class mt extends O{constructor(e){super(),j(this,e,null,at,V,{})}}export{mt as component};
