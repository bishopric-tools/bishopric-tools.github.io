import{N as fe,s as ie,M as H,p as te,f as q,a as D,g as S,w as ae,c as V,h as j,d as b,j as k,i as F,y as P,z as me,P as ge,Q as re,l as we,m as $e,I as _e}from"../chunks/scheduler.4ff403ce.js";import{S as de,i as ue,b as E,d as M,m as T,a as C,t as R,e as x,f as oe}from"../chunks/index.e99c29cb.js";import{B as he,a as ve,g as be}from"../chunks/navigation.16604d7a.js";import"../chunks/Indicator.svelte_svelte_type_style_lang.063c4f60.js";import{c as ye,a as ne,A as Pe,T as le}from"../chunks/TextField.21ca9009.js";import{w as z}from"../chunks/singletons.2db2962d.js";const Ie=()=>{const t=ye({password1:ne().required("Password1 is required"),password2:ne().required("Password2 is required")}),e=z({password1:"",password2:""}),o=z({}),a=z([]);return{store:{schema:t,model:e,errors:o,touched:a},actions:{reset:()=>{e.set({password1:"",password2:""})},destroy:()=>{console.log("destroy called")},validate:async(_,m)=>{o.set({});try{console.log("validate",_,m);const d=await t.validate({password1:_,password2:m},{abortEarly:!1});return console.log("success",d),Promise.resolve()}catch(d){throw console.log("failed",d),o.update(i=>(d.inner.forEach(f=>{i||(i={}),i[f.path]={path:f.path,message:f.message}}),i)),console.log("### errors",fe(o)),Error("Validation failed")}}}}},qe=Ie();function Se(t){let e;return{c(){e=we("Restore email password")},l(o){e=$e(o,"Restore email password")},m(o,a){F(o,e,a)},d(o){o&&b(e)}}}function ke(t){var N,O,Q,U,W,G;let e,o="Reset Password",a,s,p,u,_,m,d,i,h,f,g,A='Not registered? <a href="/auth/sign-up" class="text-primary-700 hover:underline dark:text-primary-500">Create account</a>',I,c,l,v,y;function pe(r){t[9](r)}let B={type:t[0],name:"password1",label:"Password",placeholder:"Password",disabled:t[2],isInvalid:((N=t[3])==null?void 0:N.password1)!==void 0,helperMessage:(Q=(O=t[3])==null?void 0:O.password1)==null?void 0:Q.message,novalidate:!0,required:!0};t[1].password1!==void 0&&(B.value=t[1].password1),u=new le({props:B}),te.push(()=>oe(u,"value",pe)),u.$on("input",t[7]);function ce(r){t[10](r)}let L={type:t[0],name:"password2",label:"Re-type your password",placeholder:"Password",disabled:t[2],isInvalid:((U=t[3])==null?void 0:U.password2)!==void 0,helperMessage:(G=(W=t[3])==null?void 0:W.password2)==null?void 0:G.message,novalidate:!0,required:!0};return t[1].password2!==void 0&&(L.value=t[1].password2),i=new le({props:L}),te.push(()=>oe(i,"value",ce)),i.$on("input",t[7]),c=new he({props:{type:"button",class:"w-full",$$slots:{default:[Se]},$$scope:{ctx:t}}}),c.$on("click",t[8]),{c(){e=q("h1"),e.textContent=o,a=D(),s=q("form"),p=q("div"),E(u.$$.fragment),m=D(),d=q("div"),E(i.$$.fragment),f=D(),g=q("div"),g.innerHTML=A,I=D(),E(c.$$.fragment),this.h()},l(r){e=S(r,"H1",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-rj19s"&&(e.textContent=o),a=V(r),s=S(r,"FORM",{class:!0});var n=j(s);p=S(n,"DIV",{class:!0});var w=j(p);M(u.$$.fragment,w),w.forEach(b),m=V(n),d=S(n,"DIV",{class:!0});var $=j(d);M(i.$$.fragment,$),$.forEach(b),f=V(n),g=S(n,"DIV",{class:!0,"data-svelte-h":!0}),ae(g)!=="svelte-1rrzm7r"&&(g.innerHTML=A),I=V(n),M(c.$$.fragment,n),n.forEach(b),this.h()},h(){k(e,"class","text-xl font-bold leading-tight tracking-tight text-gray-900 md:text-2xl dark:text-white"),k(p,"class","space-y-2"),k(d,"class","space-y-2"),k(g,"class","text-sm font-medium text-gray-500 dark:text-gray-300"),k(s,"class","space-y-4 md:space-y-6"),s.noValidate=!0},m(r,n){F(r,e,n),F(r,a,n),F(r,s,n),P(s,p),T(u,p,null),P(s,m),P(s,d),T(i,d,null),P(s,f),P(s,g),P(s,I),T(c,s,null),l=!0,v||(y=me(s,"submit",ge(t[8])),v=!0)},p(r,n){var K,X,Y,Z,ee,se;const w={};n&1&&(w.type=r[0]),n&4&&(w.disabled=r[2]),n&8&&(w.isInvalid=((K=r[3])==null?void 0:K.password1)!==void 0),n&8&&(w.helperMessage=(Y=(X=r[3])==null?void 0:X.password1)==null?void 0:Y.message),!_&&n&2&&(_=!0,w.value=r[1].password1,re(()=>_=!1)),u.$set(w);const $={};n&1&&($.type=r[0]),n&4&&($.disabled=r[2]),n&8&&($.isInvalid=((Z=r[3])==null?void 0:Z.password2)!==void 0),n&8&&($.helperMessage=(se=(ee=r[3])==null?void 0:ee.password2)==null?void 0:se.message),!h&&n&2&&(h=!0,$.value=r[1].password2,re(()=>h=!1)),i.$set($);const J={};n&16384&&(J.$$scope={dirty:n,ctx:r}),c.$set(J)},i(r){l||(C(u.$$.fragment,r),C(i.$$.fragment,r),C(c.$$.fragment,r),l=!0)},o(r){R(u.$$.fragment,r),R(i.$$.fragment,r),R(c.$$.fragment,r),l=!1},d(r){r&&(b(e),b(a),b(s)),x(u),x(i),x(c),v=!1,y()}}}function Ee(t){let e,o;return e=new Pe({props:{$$slots:{default:[ke]},$$scope:{ctx:t}}}),{c(){E(e.$$.fragment)},l(a){M(e.$$.fragment,a)},m(a,s){T(e,a,s),o=!0},p(a,[s]){const p={};s&16399&&(p.$$scope={dirty:s,ctx:a}),e.$set(p)},i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){R(e.$$.fragment,a),o=!1},d(a){x(e,a)}}}function Me(t,e,o){let a,s,p,u;const{actions:{resetPassword:_},store:{loading:m}}=ve;H(t,m,l=>o(2,p=l));const{store:{model:d,errors:i},actions:{validate:h}}=qe;H(t,d,l=>o(1,s=l)),H(t,i,l=>o(3,u=l));let f=!1;const g=async()=>{if(!f)return;const{password1:l,password2:v}=s;await h(l,v)},A=async()=>{try{f=!0;const{password1:l,password2:v}=s;await h(l,v);const y=await _(s.password1);y!=null&&y.success&&await be("/auth/sign-in")}catch(l){console.log("submit failed",l)}};function I(l){t.$$.not_equal(s.password1,l)&&(s.password1=l,d.set(s))}function c(l){t.$$.not_equal(s.password2,l)&&(s.password2=l,d.set(s))}return o(0,a="password"),[a,s,p,u,m,d,i,g,A,I,c]}class Te extends de{constructor(e){super(),ue(this,e,Me,Ee,ie,{})}}function Ce(t){let e,o;return e=new Te({}),{c(){E(e.$$.fragment)},l(a){M(e.$$.fragment,a)},m(a,s){T(e,a,s),o=!0},p:_e,i(a){o||(C(e.$$.fragment,a),o=!0)},o(a){R(e.$$.fragment,a),o=!1},d(a){x(e,a)}}}class He extends de{constructor(e){super(),ue(this,e,null,Ce,ie,{})}}export{He as component};
