import{s as me,r as Fe,A as Ee,f as U,a as z,g as q,h as O,d as p,c as B,D as Ye,j as S,i as C,x as R,E as ne,u as Le,v as Pe,w as Me,S as Ot,F as xe,Q as zt,G as Ve,L as wt,P as oe,l as Y,m as x,n as Te,O as Bt,y as Ae,$ as Se,e as be,z as Q,a0 as kt,p as ve,M as ye,a1 as Ct,C as Be,Z as jt}from"../chunks/scheduler.d39a3720.js";import{S as _e,i as pe,a as _,g as ie,t as h,c as ue,b as E,d as T,m as A,e as N,f as we}from"../chunks/index.07c9debd.js";import{a as Oe,r as Ce,e as et,b as ze}from"../chunks/rbac.state.c59680ed.js";import{B as ke}from"../chunks/Button.b98179ef.js";import{D as Ge,a as Ue,b as Dt,c as It}from"../chunks/DataTable.b85f2c24.js";import{w as ee,d as Ht}from"../chunks/index.42ef28c5.js";import{a as Rt}from"../chunks/auth.state.206bbbe8.js";import{n as St}from"../chunks/toaster.state.428f9499.js";import{C as Et,c as Tt}from"../chunks/CloseButton.b9a97b75.js";import{D as At}from"../chunks/Drawer.8e5fbcd1.js";import{f as Nt,c as Vt,a as Gt,b as Ut,T as qt}from"../chunks/TextField.db984a2d.js";import{S as Kt,N as Ft,I as Lt}from"../chunks/ItemHistory.2a4047cc.js";import{t as qe,g as Qt}from"../chunks/tw-merge.222c61b5.js";import{P as tt}from"../chunks/P.64a1acb6.js";const Zt=n=>({}),st=n=>({});function Jt(n){let e;return{c(){e=Y(n[1])},l(t){e=x(t,n[1])},m(t,s){C(t,e,s)},p(t,s){s&2&&Te(e,t[1])},d(t){t&&p(e)}}}function nt(n){let e,t,s,a,r;const l=n[10].default,o=Fe(l,n,n[9],null);return{c(){e=U("div"),t=U("div"),o&&o.c(),this.h()},l(i){e=q(i,"DIV",{class:!0});var u=O(e);t=q(u,"DIV",{});var d=O(t);o&&o.l(d),d.forEach(p),u.forEach(p),this.h()},h(){S(e,"class","hidden tab_content_placeholder")},m(i,u){C(i,e,u),R(e,t),o&&o.m(t,null),s=!0,a||(r=wt(n[3].call(null,t)),a=!0)},p(i,u){o&&o.p&&(!s||u&512)&&Le(o,l,i,i[9],s?Me(l,i[9],u,null):Pe(i[9]),null)},i(i){s||(_(o,i),s=!0)},o(i){h(o,i),s=!1},d(i){i&&p(e),o&&o.d(i),a=!1,r()}}}function Wt(n){let e,t,s,a,r,l,o;const i=n[10].title,u=Fe(i,n,n[9],st),d=u||Jt(n);let c=[{type:"button"},{role:"tab"},n[5],{class:n[2]}],f={};for(let b=0;b<c.length;b+=1)f=Ee(f,c[b]);let m=n[0]&&nt(n);return{c(){e=U("li"),t=U("button"),d&&d.c(),s=z(),m&&m.c(),this.h()},l(b){e=q(b,"LI",{class:!0,role:!0});var D=O(e);t=q(D,"BUTTON",{type:!0,role:!0,class:!0});var $=O(t);d&&d.l($),$.forEach(p),s=B(D),m&&m.l(D),D.forEach(p),this.h()},h(){Ye(t,f),S(e,"class",a=qe("group",n[4].class)),S(e,"role","presentation")},m(b,D){C(b,e,D),R(e,t),d&&d.m(t,null),t.autofocus&&t.focus(),R(e,s),m&&m.m(e,null),r=!0,l||(o=[ne(t,"click",n[21]),ne(t,"blur",n[11]),ne(t,"click",n[12]),ne(t,"contextmenu",n[13]),ne(t,"focus",n[14]),ne(t,"keydown",n[15]),ne(t,"keypress",n[16]),ne(t,"keyup",n[17]),ne(t,"mouseenter",n[18]),ne(t,"mouseleave",n[19]),ne(t,"mouseover",n[20])],l=!0)},p(b,[D]){u?u.p&&(!r||D&512)&&Le(u,i,b,b[9],r?Me(i,b[9],D,Zt):Pe(b[9]),st):d&&d.p&&(!r||D&2)&&d.p(b,r?D:-1),Ye(t,f=Qt(c,[{type:"button"},{role:"tab"},D&32&&b[5],(!r||D&4)&&{class:b[2]}])),b[0]?m?(m.p(b,D),D&1&&_(m,1)):(m=nt(b),m.c(),_(m,1),m.m(e,null)):m&&(ie(),h(m,1,1,()=>{m=null}),ue()),(!r||D&16&&a!==(a=qe("group",b[4].class)))&&S(e,"class",a)},i(b){r||(_(d,b),_(m),r=!0)},o(b){h(d,b),h(m),r=!1},d(b){b&&p(e),d&&d.d(b),m&&m.d(),l=!1,Ot(o)}}}function Xt(n,e,t){const s=["open","title","activeClasses","inactiveClasses","defaultClass"];let a=xe(e,s),{$$slots:r={},$$scope:l}=e,{open:o=!1}=e,{title:i="Tab title"}=e,{activeClasses:u=void 0}=e,{inactiveClasses:d=void 0}=e,{defaultClass:c="inline-block text-sm font-medium text-center disabled:cursor-not-allowed"}=e;const f=zt("ctx")??{},m=f.selected??ee();function b(k){return m.set(k),{destroy:m.subscribe(P=>{P!==k&&t(0,o=!1)})}}let D;function $(k){oe.call(this,n,k)}function j(k){oe.call(this,n,k)}function Z(k){oe.call(this,n,k)}function H(k){oe.call(this,n,k)}function G(k){oe.call(this,n,k)}function I(k){oe.call(this,n,k)}function K(k){oe.call(this,n,k)}function J(k){oe.call(this,n,k)}function V(k){oe.call(this,n,k)}function L(k){oe.call(this,n,k)}const le=()=>t(0,o=!0);return n.$$set=k=>{t(4,e=Ee(Ee({},e),Ve(k))),t(5,a=xe(e,s)),"open"in k&&t(0,o=k.open),"title"in k&&t(1,i=k.title),"activeClasses"in k&&t(6,u=k.activeClasses),"inactiveClasses"in k&&t(7,d=k.inactiveClasses),"defaultClass"in k&&t(8,c=k.defaultClass),"$$scope"in k&&t(9,l=k.$$scope)},n.$$.update=()=>{n.$$.dirty&449&&t(2,D=qe(c,o?u??f.activeClasses:d??f.inactiveClasses,o&&"active"))},e=Ve(e),[o,i,D,b,e,a,u,d,c,l,r,$,j,Z,H,G,I,K,J,V,L,le]}class rt extends _e{constructor(e){super(),pe(this,e,Xt,Wt,me,{open:0,title:1,activeClasses:6,inactiveClasses:7,defaultClass:8})}}const Yt=n=>({}),at=n=>({}),xt=n=>({style:n&2}),lt=n=>({style:n[1]});function ot(n){let e;const t=n[9].divider,s=Fe(t,n,n[8],at),a=s||es();return{c(){a&&a.c()},l(r){a&&a.l(r)},m(r,l){a&&a.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l&256)&&Le(s,t,r,r[8],e?Me(t,r[8],l,Yt):Pe(r[8]),at)},i(r){e||(_(a,r),e=!0)},o(r){h(a,r),e=!1},d(r){a&&a.d(r)}}}function es(n){let e;return{c(){e=U("div"),this.h()},l(t){e=q(t,"DIV",{class:!0}),O(e).forEach(p),this.h()},h(){S(e,"class","h-px bg-gray-200 dark:bg-gray-700")},m(t,s){C(t,e,s)},p:Ae,d(t){t&&p(e)}}}function ts(n){let e,t,s,a,r,l,o;const i=n[9].default,u=Fe(i,n,n[8],lt);let d=n[0]&&ot(n);return{c(){e=U("ul"),u&&u.c(),t=z(),d&&d.c(),s=z(),a=U("div"),this.h()},l(c){e=q(c,"UL",{class:!0});var f=O(e);u&&u.l(f),f.forEach(p),t=B(c),d&&d.l(c),s=B(c),a=q(c,"DIV",{class:!0,role:!0,"aria-labelledby":!0}),O(a).forEach(p),this.h()},h(){S(e,"class",n[3]),S(a,"class",n[2]),S(a,"role","tabpanel"),S(a,"aria-labelledby","id-tab")},m(c,f){C(c,e,f),u&&u.m(e,null),C(c,t,f),d&&d.m(c,f),C(c,s,f),C(c,a,f),r=!0,l||(o=wt(n[4].call(null,a)),l=!0)},p(c,[f]){u&&u.p&&(!r||f&258)&&Le(u,i,c,c[8],r?Me(i,c[8],f,xt):Pe(c[8]),lt),(!r||f&8)&&S(e,"class",c[3]),c[0]?d?(d.p(c,f),f&1&&_(d,1)):(d=ot(c),d.c(),_(d,1),d.m(s.parentNode,s)):d&&(ie(),h(d,1,1,()=>{d=null}),ue()),(!r||f&4)&&S(a,"class",c[2])},i(c){r||(_(u,c),_(d),r=!0)},o(c){h(u,c),h(d),r=!1},d(c){c&&(p(e),p(t),p(s),p(a)),u&&u.d(c),d&&d.d(c),l=!1,o()}}}function ss(n,e,t){let s,{$$slots:a={},$$scope:r}=e,{style:l="none"}=e,{defaultClass:o="flex flex-wrap space-x-2"}=e,{contentClass:i="p-4 bg-gray-50 rounded-lg dark:bg-gray-800 mt-4"}=e,{divider:u=!0}=e,{activeClasses:d="p-4 text-primary-600 bg-gray-100 rounded-t-lg dark:bg-gray-800 dark:text-primary-500"}=e,{inactiveClasses:c="p-4 text-gray-500 rounded-t-lg hover:text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-gray-300"}=e;const f={full:"p-4 w-full group-first:rounded-l-lg group-last:rounded-r-lg text-gray-900 bg-gray-100 focus:ring-4 focus:ring-primary-300 focus:outline-none dark:bg-gray-700 dark:text-white",pill:"py-3 px-4 text-white bg-primary-600 rounded-lg",underline:"p-4 text-primary-600 border-b-2 border-primary-600 dark:text-primary-500 dark:border-primary-500",none:""},m={full:"p-4 w-full group-first:rounded-l-lg group-last:rounded-r-lg text-gray-500 dark:text-gray-400 bg-white hover:text-gray-700 hover:bg-gray-50 focus:ring-4 focus:ring-primary-300 focus:outline-none dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700",pill:"py-3 px-4 text-gray-500 rounded-lg hover:text-gray-900 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 dark:hover:text-white",underline:"p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 text-gray-500 dark:text-gray-400",none:""},b={activeClasses:f[l]||d,inactiveClasses:m[l]||c,selected:ee()};Bt("ctx",b);function D($){return{destroy:b.selected.subscribe(Z=>{Z&&$.replaceChildren(Z)})}}return n.$$set=$=>{t(13,e=Ee(Ee({},e),Ve($))),"style"in $&&t(1,l=$.style),"defaultClass"in $&&t(5,o=$.defaultClass),"contentClass"in $&&t(2,i=$.contentClass),"divider"in $&&t(0,u=$.divider),"activeClasses"in $&&t(6,d=$.activeClasses),"inactiveClasses"in $&&t(7,c=$.inactiveClasses),"$$scope"in $&&t(8,r=$.$$scope)},n.$$.update=()=>{n.$$.dirty&3&&t(0,u=["full","pill"].includes(l)?!1:u),t(3,s=qe(o,l==="underline"&&"-mb-px",e.class))},e=Ve(e),[u,l,i,s,D,o,d,c,r,a]}class ns extends _e{constructor(e){super(),pe(this,e,ss,ts,me,{style:1,defaultClass:5,contentClass:2,divider:0,activeClasses:6,inactiveClasses:7})}}let re=null;const rs=()=>(re={drawerClosed:ee(!0),focusedUser:ee(null),closeDrawer:()=>{var n,e;re&&((e=(n=re==null?void 0:re.drawerClosed)==null?void 0:n.set)==null||e.call(n,!0))},openDrawer:()=>{var n,e;re&&((e=(n=re==null?void 0:re.drawerClosed)==null?void 0:n.set)==null||e.call(n,!1))}},re),as=()=>{re=null},je=()=>re||rs(),{store:{currentUser:it,currentSession:Cn}}=Rt,{store:{roles:ls}}=Ce,{action:{toastify:Ie}}=St,os={name:"",sort_index:0,role_group_id:0},is={name:"",sort_index:0,group_id:"0"};let fe=null;const us=()=>(fe={loading:ee(!1),model:ee(is),action:ee("view"),targetRole:ee(os),addRole:async n=>{var e,t,s,a;try{let r=n.sort_index;n.sort_index||(r=(((e=Se(ls).sort((i,u)=>!(u!=null&&u.sort_index)||!(i!=null&&i.sort_index)?0:u.sort_index-i.sort_index)[1])==null?void 0:e.sort_index)??0)+1);const l=[{name:n.name,sort_index:r,role_group_id:n.role_group_id,created_by_id:(t=Se(it))==null?void 0:t.id,created_at:new Date().toISOString()}];await Oe.bulkCreate(l),(a=(s=fe==null?void 0:fe.targetRole)==null?void 0:s.set)==null||a.call(s,null),Ie({type:"success",message:"Updated role successfully"})}catch{Ie({type:"error",message:"Update role failed, please refresh browser and try again."})}},updateRole:async n=>{var e,t,s;try{const a=[{name:n.name,sort_index:n.sort_index,uuid:n.uuid,role_group_id:n.role_group_id,updated_by_id:(e=Se(it))==null?void 0:e.id,updated_at:new Date().toISOString()}];await Oe.bulkUpdate(a,{onConflict:"uuid"}),(s=(t=fe==null?void 0:fe.targetRole)==null?void 0:t.set)==null||s.call(t,null),Ie({type:"success",message:"Updated role successfully."})}catch{Ie({type:"error",message:"Update role failed, please refresh browser and try again."})}},deleteRole:async n=>{if(n)try{await Oe.bulkDelete([n]),Ie({type:"success",message:"Deleted role successfully."})}catch{Ie({type:"error",message:"Delete role failed, please refresh browser and try again."})}}},fe),Pt=()=>fe===null?us():fe,ds=()=>{fe=null};function ut(n){let e,t;return e=new Dt({props:{options:n[1],data:n[3],loading:n[4],$$slots:{header:[cs]},$$scope:{ctx:n}}}),{c(){E(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){A(e,s,a),t=!0},p(s,a){const r={};a&2&&(r.options=s[1]),a&8&&(r.data=s[3]),a&16&&(r.loading=s[4]),a&262145&&(r.$$scope={dirty:a,ctx:s}),e.$set(r)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){h(e.$$.fragment,s),t=!1},d(s){N(e,s)}}}function fs(n){let e;return{c(){e=Y("Add")},l(t){e=x(t,"Add")},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function cs(n){let e,t,s,a,r,l;return r=new ke({props:{size:"xs",color:"alternative",$$slots:{default:[fs]},$$scope:{ctx:n}}}),r.$on("click",n[9]),{c(){e=U("div"),t=U("p"),s=Y(n[0]),a=z(),E(r.$$.fragment),this.h()},l(o){e=q(o,"DIV",{slot:!0,class:!0});var i=O(e);t=q(i,"P",{class:!0});var u=O(t);s=x(u,n[0]),u.forEach(p),a=B(i),T(r.$$.fragment,i),i.forEach(p),this.h()},h(){S(t,"class","dark:text-white text-lg"),S(e,"slot","header"),S(e,"class","flex justify-between mb-0 items-center mx-md-5")},m(o,i){C(o,e,i),R(e,t),R(t,s),R(e,a),A(r,e,null),l=!0},p(o,i){(!l||i&1)&&Te(s,o[0]);const u={};i&262144&&(u.$$scope={dirty:i,ctx:o}),r.$set(u)},i(o){l||(_(r.$$.fragment,o),l=!0)},o(o){h(r.$$.fragment,o),l=!1},d(o){o&&p(e),N(r)}}}function ms(n){let e,t,s=n[1]&&n[2]&&n[2].length>0&&ut(n);return{c(){s&&s.c(),e=be()},l(a){s&&s.l(a),e=be()},m(a,r){s&&s.m(a,r),C(a,e,r),t=!0},p(a,[r]){a[1]&&a[2]&&a[2].length>0?s?(s.p(a,r),r&6&&_(s,1)):(s=ut(a),s.c(),_(s,1),s.m(e.parentNode,e)):s&&(ie(),h(s,1,1,()=>{s=null}),ue())},i(a){t||(_(s),t=!0)},o(a){h(s),t=!1},d(a){a&&p(e),s&&s.d(a)}}}function _s(n,e,t){let s,a,r,l,{title:o="Roles"}=e,{group_id:i=1}=e;const{store:{roles:u}}=Ce;Q(n,u,I=>t(2,a=I));const{openDrawer:d}=je(),{targetRole:c,action:f}=Pt(),{loading:m}=u;Q(n,m,I=>t(4,l=I));const b={onRowClick:I=>{f.set("update"),d();const K={...I},J={id:K.id,name:K.name,role_group_id:K.group_id,sort_index:K.sort_index,uuid:K.uuid,created_by_id:K.created_by_id,created_at:K.created_at,updated_by_id:K.updated_by_id,updated_at:K.updated_at};c.set(J)},columnDefs:[{label:"Name",dataProperty:"name",dataType:Ge.String,viewAlignment:Ue.Left},{label:"Sort Index",dataProperty:"sort_index",dataType:Ge.String,viewAlignment:Ue.Right}]},D=It(b),{store:{options:$,data:j},actions:{setRowData:Z}}=D;Q(n,$,I=>t(1,s=I)),Q(n,j,I=>t(3,r=I));const H=()=>{f.set("add"),c.set({name:"",sort_index:0,role_group_id:i}),d()},G=u.subscribe(I=>{const K=I.filter(J=>J.group_id===i).sort(({sort_index:J},{sort_index:V})=>J-V);Z(K)});return kt(()=>{G(),as(),ds()}),n.$$set=I=>{"title"in I&&t(0,o=I.title),"group_id"in I&&t(10,i=I.group_id)},[o,s,a,r,l,u,m,$,j,H,i]}class ps extends _e{constructor(e){super(),pe(this,e,_s,ms,me,{title:0,group_id:10})}}function gs(n){let e,t,s;function a(l){n[6](l)}let r={label:n[1],name:n[2],items:n[3]};return n[0]!==void 0&&(r.value=n[0]),e=new Kt({props:r}),ve.push(()=>we(e,"value",a)),{c(){E(e.$$.fragment)},l(l){T(e.$$.fragment,l)},m(l,o){A(e,l,o),s=!0},p(l,[o]){const i={};o&2&&(i.label=l[1]),o&4&&(i.name=l[2]),o&8&&(i.items=l[3]),!t&&o&1&&(t=!0,i.value=l[0],ye(()=>t=!1)),e.$set(i)},i(l){s||(_(e.$$.fragment,l),s=!0)},o(l){h(e.$$.fragment,l),s=!1},d(l){N(e,l)}}}function bs(n,e,t){let s,a,{label:r=""}=e,{name:l=""}=e,{value:o}=e;const{store:{roleGroups:i}}=Ce;Q(n,i,d=>t(5,a=d));function u(d){o=d,t(0,o)}return n.$$set=d=>{"label"in d&&t(1,r=d.label),"name"in d&&t(2,l=d.name),"value"in d&&t(0,o=d.value)},n.$$.update=()=>{n.$$.dirty&32&&t(3,s=a.map(d=>({value:d.id+"",name:`${d.name}`})))},[o,r,l,s,i,a,u]}class hs extends _e{constructor(e){super(),pe(this,e,bs,gs,me,{label:1,name:2,value:0})}}function dt(n){var w,y,M,X,te,he;let e,t,s,a,r,l,o,i,u,d,c,f,m,b,D,$,j,Z,H,G,I,K;function J(v){n[15](v)}let V={type:"text",name:"role-name",label:"Name",placeholder:"Name",disabled:n[3],isInvalid:((w=n[4])==null?void 0:w.name)!==void 0,helperMessage:(M=(y=n[4])==null?void 0:y.name)==null?void 0:M.message,novalidate:!0,required:!0};n[2].name!==void 0&&(V.value=n[2].name),s=new qt({props:V}),ve.push(()=>we(s,"value",J)),s.$on("input",n[12]);function L(v){n[16](v)}let le={name:"role-sort-index",label:"Sort Index",disabled:n[3],isInvalid:((X=n[4])==null?void 0:X.sort_index)!==void 0,helperMessage:(he=(te=n[4])==null?void 0:te.sort_index)==null?void 0:he.message,novalidate:!0,required:!0};n[2].sort_index!==void 0&&(le.value=n[2].sort_index),l=new Ft({props:le}),ve.push(()=>we(l,"value",L)),l.$on("input",n[12]);function k(v){n[17](v)}let ge={name:"role-group",label:"Role Group"};n[2].group_id!==void 0&&(ge.value=n[2].group_id),u=new hs({props:ge}),ve.push(()=>we(u,"value",k));let P=n[1]==="update"&&ft(n),g=n[1]!=="add"&&ct(n);return j=new ke({props:{type:"button",size:"xs",class:"mr-2",color:"alternative",disabled:n[3],$$slots:{default:[vs]},$$scope:{ctx:n}}}),j.$on("click",n[11]),H=new ke({props:{type:"button",size:"xs",disabled:n[3],$$slots:{default:[ks]},$$scope:{ctx:n}}}),H.$on("click",n[13]),{c(){e=U("form"),t=U("div"),E(s.$$.fragment),r=z(),E(l.$$.fragment),i=z(),E(u.$$.fragment),c=z(),P&&P.c(),f=z(),m=U("div"),b=U("div"),g&&g.c(),D=z(),$=U("div"),E(j.$$.fragment),Z=z(),E(H.$$.fragment),this.h()},l(v){e=q(v,"FORM",{class:!0});var F=O(e);t=q(F,"DIV",{class:!0});var W=O(t);T(s.$$.fragment,W),r=B(W),T(l.$$.fragment,W),i=B(W),T(u.$$.fragment,W),c=B(W),P&&P.l(W),W.forEach(p),f=B(F),m=q(F,"DIV",{class:!0});var se=O(m);b=q(se,"DIV",{});var $e=O(b);g&&g.l($e),$e.forEach(p),D=B(se),$=q(se,"DIV",{});var de=O($);T(j.$$.fragment,de),Z=B(de),T(H.$$.fragment,de),de.forEach(p),se.forEach(p),F.forEach(p),this.h()},h(){S(t,"class","space-y-6"),S(m,"class","flex justify-between"),e.noValidate=!0,S(e,"class","form mb-0 flex flex-col justify-between svelte-1dy7x2v")},m(v,F){C(v,e,F),R(e,t),A(s,t,null),R(t,r),A(l,t,null),R(t,i),A(u,t,null),R(t,c),P&&P.m(t,null),R(e,f),R(e,m),R(m,b),g&&g.m(b,null),R(m,D),R(m,$),A(j,$,null),R($,Z),A(H,$,null),G=!0,I||(K=ne(e,"submit",Ct(n[14])),I=!0)},p(v,F){var Ke,Qe,Ze,Je,We,Xe;const W={};F&8&&(W.disabled=v[3]),F&16&&(W.isInvalid=((Ke=v[4])==null?void 0:Ke.name)!==void 0),F&16&&(W.helperMessage=(Ze=(Qe=v[4])==null?void 0:Qe.name)==null?void 0:Ze.message),!a&&F&4&&(a=!0,W.value=v[2].name,ye(()=>a=!1)),s.$set(W);const se={};F&8&&(se.disabled=v[3]),F&16&&(se.isInvalid=((Je=v[4])==null?void 0:Je.sort_index)!==void 0),F&16&&(se.helperMessage=(Xe=(We=v[4])==null?void 0:We.sort_index)==null?void 0:Xe.message),!o&&F&4&&(o=!0,se.value=v[2].sort_index,ye(()=>o=!1)),l.$set(se);const $e={};!d&&F&4&&(d=!0,$e.value=v[2].group_id,ye(()=>d=!1)),u.$set($e),v[1]==="update"?P?(P.p(v,F),F&2&&_(P,1)):(P=ft(v),P.c(),_(P,1),P.m(t,null)):P&&(ie(),h(P,1,1,()=>{P=null}),ue()),v[1]!=="add"?g?(g.p(v,F),F&2&&_(g,1)):(g=ct(v),g.c(),_(g,1),g.m(b,null)):g&&(ie(),h(g,1,1,()=>{g=null}),ue());const de={};F&8&&(de.disabled=v[3]),F&134217728&&(de.$$scope={dirty:F,ctx:v}),j.$set(de);const De={};F&8&&(De.disabled=v[3]),F&134217738&&(De.$$scope={dirty:F,ctx:v}),H.$set(De)},i(v){G||(_(s.$$.fragment,v),_(l.$$.fragment,v),_(u.$$.fragment,v),_(P),_(g),_(j.$$.fragment,v),_(H.$$.fragment,v),G=!0)},o(v){h(s.$$.fragment,v),h(l.$$.fragment,v),h(u.$$.fragment,v),h(P),h(g),h(j.$$.fragment,v),h(H.$$.fragment,v),G=!1},d(v){v&&p(e),N(s),N(l),N(u),P&&P.d(),g&&g.d(),N(j),N(H),I=!1,K()}}}function ft(n){var s,a,r,l;let e,t;return e=new Lt({props:{created_at:(s=n[0])==null?void 0:s.created_at,created_by_id:(a=n[0])==null?void 0:a.created_by_id,updated_at:(r=n[0])==null?void 0:r.updated_at,updated_by_id:(l=n[0])==null?void 0:l.updated_by_id}}),{c(){E(e.$$.fragment)},l(o){T(e.$$.fragment,o)},m(o,i){A(e,o,i),t=!0},p(o,i){var d,c,f,m;const u={};i&1&&(u.created_at=(d=o[0])==null?void 0:d.created_at),i&1&&(u.created_by_id=(c=o[0])==null?void 0:c.created_by_id),i&1&&(u.updated_at=(f=o[0])==null?void 0:f.updated_at),i&1&&(u.updated_by_id=(m=o[0])==null?void 0:m.updated_by_id),e.$set(u)},i(o){t||(_(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){N(e,o)}}}function ct(n){let e,t;return e=new ke({props:{type:"button",size:"xs",color:"red",disabled:n[3],$$slots:{default:[$s]},$$scope:{ctx:n}}}),e.$on("click",n[18]),{c(){E(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){A(e,s,a),t=!0},p(s,a){const r={};a&8&&(r.disabled=s[3]),a&134217728&&(r.$$scope={dirty:a,ctx:s}),e.$set(r)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){h(e.$$.fragment,s),t=!1},d(s){N(e,s)}}}function $s(n){let e;return{c(){e=Y("Delete")},l(t){e=x(t,"Delete")},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function vs(n){let e;return{c(){e=Y("Reset")},l(t){e=x(t,"Reset")},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function ys(n){let e=n[1]==="add"?"Add":"Update",t;return{c(){t=Y(e)},l(s){t=x(s,e)},m(s,a){C(s,t,a)},p(s,a){a&2&&e!==(e=s[1]==="add"?"Add":"Update")&&Te(t,e)},d(s){s&&p(t)}}}function ws(n){let e;return{c(){e=Y("...")},l(t){e=x(t,"...")},m(t,s){C(t,e,s)},p:Ae,d(t){t&&p(e)}}}function ks(n){let e;function t(r,l){return r[3]?ws:ys}let s=t(n),a=s(n);return{c(){a.c(),e=be()},l(r){a.l(r),e=be()},m(r,l){a.m(r,l),C(r,e,l)},p(r,l){s===(s=t(r))&&a?a.p(r,l):(a.d(1),a=s(r),a&&(a.c(),a.m(e.parentNode,e)))},d(r){r&&p(e),a.d(r)}}}function Cs(n){let e,t,s=n[2]&&dt(n);return{c(){s&&s.c(),e=be()},l(a){s&&s.l(a),e=be()},m(a,r){s&&s.m(a,r),C(a,e,r),t=!0},p(a,[r]){a[2]?s?(s.p(a,r),r&4&&_(s,1)):(s=dt(a),s.c(),_(s,1),s.m(e.parentNode,e)):s&&(ie(),h(s,1,1,()=>{s=null}),ue())},i(a){t||(_(s),t=!0)},o(a){h(s),t=!1},d(a){a&&p(e),s&&s.d(a)}}}function Ds(n,e,t){let s,a,r,l,o,i;const{loading:u,targetRole:d,model:c,action:f,addRole:m,updateRole:b,deleteRole:D}=Pt();Q(n,u,g=>t(3,o=g)),Q(n,d,g=>t(0,s=g)),Q(n,c,g=>t(2,r=g)),Q(n,f,g=>t(1,a=g));const{closeDrawer:$}=je(),{store:{roles:j}}=Ce,{errors:Z,submitted:H,validate:G,reset:I}=Nt(Vt({name:Gt().required("Name is required").label("Name"),sort_index:Ut().required().label("Sort Index")}));Q(n,Z,g=>t(4,i=g)),Q(n,H,g=>t(19,l=g));const K=()=>{s&&c.set({name:s.name,sort_index:(s==null?void 0:s.sort_index)??0,group_id:`${s==null?void 0:s.role_group_id}`??"0"}),H.set(!1),I()},J=async()=>{if(!l)return;const{name:g,sort_index:w}=r;await G({name:g,sort_index:w})},V=async()=>{try{u.set(!0),H.set(!0);const{name:g,sort_index:w,group_id:y}=r;switch(await G({name:g,sort_index:w}),a){case"add":await m({...s,name:g,sort_index:w,role_group_id:parseInt(y,10)});break;case"update":await b({...s,name:g,sort_index:w,role_group_id:parseInt(y,10)});break;case"delete":s!=null&&s.id&&await D(s.id);break;default:}await j.reload(),$()}catch(g){console.log("submit failed",g)}finally{u.set(!1)}};d.subscribe(g=>{g&&c.set({name:g==null?void 0:g.name,sort_index:(g==null?void 0:g.sort_index)??0,group_id:`${g==null?void 0:g.role_group_id}`??"0"})});function L(g){oe.call(this,n,g)}function le(g){n.$$.not_equal(r.name,g)&&(r.name=g,c.set(r))}function k(g){n.$$.not_equal(r.sort_index,g)&&(r.sort_index=g,c.set(r))}function ge(g){n.$$.not_equal(r.group_id,g)&&(r.group_id=g,c.set(r))}return[s,a,r,o,i,u,d,c,f,Z,H,K,J,V,L,le,k,ge,()=>{f.set("delete"),V()}]}class Is extends _e{constructor(e){super(),pe(this,e,Ds,Cs,me,{})}}function Rs(n){let e,t,s="Role",a,r,l,o,i;return r=new Et({props:{class:"mb-4 dark:text-white"}}),r.$on("click",n[3]),o=new Is({}),{c(){e=U("div"),t=U("h5"),t.textContent=s,a=z(),E(r.$$.fragment),l=z(),E(o.$$.fragment),this.h()},l(u){e=q(u,"DIV",{class:!0});var d=O(e);t=q(d,"H5",{id:!0,class:!0,"data-svelte-h":!0}),Be(t)!=="svelte-1mqrwvg"&&(t.textContent=s),a=B(d),T(r.$$.fragment,d),d.forEach(p),l=B(u),T(o.$$.fragment,u),this.h()},h(){S(t,"id","drawer-label"),S(t,"class","inline-flex items-center mb-6 text-base font-semibold text-gray-500 uppercase dark:text-gray-400"),S(e,"class","flex items-center")},m(u,d){C(u,e,d),R(e,t),R(e,a),A(r,e,null),C(u,l,d),A(o,u,d),i=!0},p:Ae,i(u){i||(_(r.$$.fragment,u),_(o.$$.fragment,u),i=!0)},o(u){h(r.$$.fragment,u),h(o.$$.fragment,u),i=!1},d(u){u&&(p(e),p(l)),N(r),N(o,u)}}}function Ss(n){let e,t,s;function a(l){n[4](l)}let r={transitionType:"fly",transitionParams:n[1],id:"roles-drawer",placement:"right",class:"mt-0",$$slots:{default:[Rs]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.hidden=n[0]),e=new At({props:r}),ve.push(()=>we(e,"hidden",a)),{c(){E(e.$$.fragment)},l(l){T(e.$$.fragment,l)},m(l,o){A(e,l,o),s=!0},p(l,[o]){const i={};o&32&&(i.$$scope={dirty:o,ctx:l}),!t&&o&1&&(t=!0,i.hidden=l[0],ye(()=>t=!1)),e.$set(i)},i(l){s||(_(e.$$.fragment,l),s=!0)},o(l){h(e.$$.fragment,l),s=!1},d(l){N(e,l)}}}function Es(n,e,t){let s,a={x:320,duration:200,easing:Tt};const{drawerClosed:r,closeDrawer:l}=je();Q(n,r,i=>t(0,s=i));function o(i){s=i,r.set(s)}return[s,a,r,l,o]}class Ts extends _e{constructor(e){super(),pe(this,e,Es,Ss,me,{})}}function mt(n,e,t){const s=n.slice();return s[2]=e[t],s}function _t(n){let e,t,s=et(n[0]),a=[];for(let l=0;l<s.length;l+=1)a[l]=pt(mt(n,s,l));const r=l=>h(a[l],1,1,()=>{a[l]=null});return{c(){e=U("div");for(let l=0;l<a.length;l+=1)a[l].c();this.h()},l(l){e=q(l,"DIV",{class:!0});var o=O(e);for(let i=0;i<a.length;i+=1)a[i].l(o);o.forEach(p),this.h()},h(){S(e,"class","flex flex-col space-y-8")},m(l,o){C(l,e,o);for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(e,null);t=!0},p(l,o){if(o&1){s=et(l[0]);let i;for(i=0;i<s.length;i+=1){const u=mt(l,s,i);a[i]?(a[i].p(u,o),_(a[i],1)):(a[i]=pt(u),a[i].c(),_(a[i],1),a[i].m(e,null))}for(ie(),i=s.length;i<a.length;i+=1)r(i);ue()}},i(l){if(!t){for(let o=0;o<s.length;o+=1)_(a[o]);t=!0}},o(l){a=a.filter(Boolean);for(let o=0;o<a.length;o+=1)h(a[o]);t=!1},d(l){l&&p(e),jt(a,l)}}}function pt(n){let e,t,s,a;return t=new ps({props:{title:n[2].name,group_id:n[2].id}}),{c(){e=U("div"),E(t.$$.fragment),s=z(),this.h()},l(r){e=q(r,"DIV",{class:!0});var l=O(e);T(t.$$.fragment,l),s=B(l),l.forEach(p),this.h()},h(){S(e,"class","flex flex-col space-y-3")},m(r,l){C(r,e,l),A(t,e,null),R(e,s),a=!0},p(r,l){const o={};l&1&&(o.title=r[2].name),l&1&&(o.group_id=r[2].id),t.$set(o)},i(r){a||(_(t.$$.fragment,r),a=!0)},o(r){h(t.$$.fragment,r),a=!1},d(r){r&&p(e),N(t)}}}function As(n){let e,t,s,a=n[0]&&n[0].length>0&&_t(n);return t=new Ts({}),{c(){a&&a.c(),e=z(),E(t.$$.fragment)},l(r){a&&a.l(r),e=B(r),T(t.$$.fragment,r)},m(r,l){a&&a.m(r,l),C(r,e,l),A(t,r,l),s=!0},p(r,[l]){r[0]&&r[0].length>0?a?(a.p(r,l),l&1&&_(a,1)):(a=_t(r),a.c(),_(a,1),a.m(e.parentNode,e)):a&&(ie(),h(a,1,1,()=>{a=null}),ue())},i(r){s||(_(a),_(t.$$.fragment,r),s=!0)},o(r){h(a),h(t.$$.fragment,r),s=!1},d(r){r&&p(e),a&&a.d(r),N(t,r)}}}function Ns(n,e,t){let s;const{store:{roleGroups:a}}=Ce;return Q(n,a,r=>t(0,s=r)),[s,a]}class Vs extends _e{constructor(e){super(),pe(this,e,Ns,As,me,{})}}let ae=null;const Gs=()=>(ae={drawerClosed:ee(!0),focusedUser:ee(null),closeDrawer:()=>{ae!=null&&ae.drawerClosed&&ae.drawerClosed.set(!0)},openDrawer:()=>{ae!=null&&ae.drawerClosed&&ae.drawerClosed.set(!1)}},ae),Us=()=>{ae=null},He=()=>ae||Gs(),{store:{currentUser:gt}}=Rt,{store:{roles:bt,users:Dn}}=Ce,{action:{toastify:Re}}=St,qs={name:"",sort_index:0},Fs={name:"",sort_index:0};let ce=null,Ne=null;const Ls=()=>(Ne=ee(qs),ce={loading:ee(!1),model:ee(Fs),action:ee("view"),targetRoleGroup:Ne,canDelete:Ht([bt,Ne],([n,e])=>{if(!e)return!1;const t=n.filter(s=>s.group_id===e.id);return console.log("### can delete",t),t.length===0}),addRoleGroup:async n=>{var e,t,s,a;try{let r=n.sort_index;n.sort_index||(r=(((e=Se(bt).sort((i,u)=>!(u!=null&&u.sort_index)||!(i!=null&&i.sort_index)?0:u.sort_index-i.sort_index)[1])==null?void 0:e.sort_index)??0)+1);const l=[{name:n.name,sort_index:r,created_by_id:(t=Se(gt))==null?void 0:t.id,created_at:new Date().toISOString()}];await ze.bulkCreate(l),(a=(s=ce==null?void 0:ce.targetRoleGroup)==null?void 0:s.set)==null||a.call(s,null),Re({type:"success",message:"Updated role group successfully"}),console.log("### addRoleGroup done")}catch(r){console.log("### addRoleGroup failed",r),Re({type:"error",message:"Update role group failed, please refresh browser and try again."})}},updateRoleGroup:async n=>{var e,t,s;try{const a=[{name:n.name,sort_index:n.sort_index,uuid:n.uuid,updated_by_id:(e=Se(gt))==null?void 0:e.id,updated_at:new Date().toISOString()}];await ze.bulkUpdate(a,{onConflict:"uuid"}),(s=(t=ce==null?void 0:ce.targetRoleGroup)==null?void 0:t.set)==null||s.call(t,null),Re({type:"success",message:"Updated role group successfully."})}catch{Re({type:"error",message:"Update role group failed, please refresh browser and try again."})}},deleteRoleGroup:async n=>{if(n)try{await ze.bulkDelete([n]),Re({type:"success",message:"Deleted role successfully."})}catch{Re({type:"error",message:"Delete role failed, please refresh browser and try again."})}}},ce),Mt=()=>ce===null?Ls():ce,Ps=()=>{ce=null,Ne=null};function ht(n){var le,k,ge,P,g,w;let e,t,s,a,r,l,o,i,u,d,c,f,m,b,D,$,j,Z,H;function G(y){n[17](y)}let I={type:"text",name:"role-group-name",label:"Name",placeholder:"Name",disabled:n[3],isInvalid:((le=n[4])==null?void 0:le.name)!==void 0,helperMessage:(ge=(k=n[4])==null?void 0:k.name)==null?void 0:ge.message,novalidate:!0,required:!0};n[2].name!==void 0&&(I.value=n[2].name),s=new qt({props:I}),ve.push(()=>we(s,"value",G)),s.$on("input",n[14]);function K(y){n[18](y)}let J={name:"role-group-sort-index",label:"Sort Index",disabled:n[3],isInvalid:((P=n[4])==null?void 0:P.sort_index)!==void 0,helperMessage:(w=(g=n[4])==null?void 0:g.sort_index)==null?void 0:w.message,novalidate:!0,required:!0};n[2].sort_index!==void 0&&(J.value=n[2].sort_index),l=new Ft({props:J}),ve.push(()=>we(l,"value",K)),l.$on("input",n[14]);let V=n[1]==="update"&&$t(n),L=n[1]!=="add"&&n[5]&&vt(n);return b=new ke({props:{type:"button",size:"xs",class:"mr-2",color:"alternative",disabled:n[3],$$slots:{default:[Os]},$$scope:{ctx:n}}}),b.$on("click",n[13]),$=new ke({props:{type:"button",size:"xs",disabled:n[3],$$slots:{default:[js]},$$scope:{ctx:n}}}),$.$on("click",n[15]),{c(){e=U("form"),t=U("div"),E(s.$$.fragment),r=z(),E(l.$$.fragment),i=z(),V&&V.c(),u=z(),d=U("div"),c=U("div"),L&&L.c(),f=z(),m=U("div"),E(b.$$.fragment),D=z(),E($.$$.fragment),this.h()},l(y){e=q(y,"FORM",{class:!0});var M=O(e);t=q(M,"DIV",{class:!0});var X=O(t);T(s.$$.fragment,X),r=B(X),T(l.$$.fragment,X),i=B(X),V&&V.l(X),X.forEach(p),u=B(M),d=q(M,"DIV",{class:!0});var te=O(d);c=q(te,"DIV",{});var he=O(c);L&&L.l(he),he.forEach(p),f=B(te),m=q(te,"DIV",{});var v=O(m);T(b.$$.fragment,v),D=B(v),T($.$$.fragment,v),v.forEach(p),te.forEach(p),M.forEach(p),this.h()},h(){S(t,"class","space-y-6"),S(d,"class","flex justify-between"),e.noValidate=!0,S(e,"class","form mb-0 flex flex-col justify-between svelte-1dy7x2v")},m(y,M){C(y,e,M),R(e,t),A(s,t,null),R(t,r),A(l,t,null),R(t,i),V&&V.m(t,null),R(e,u),R(e,d),R(d,c),L&&L.m(c,null),R(d,f),R(d,m),A(b,m,null),R(m,D),A($,m,null),j=!0,Z||(H=ne(e,"submit",Ct(n[16])),Z=!0)},p(y,M){var F,W,se,$e,de,De;const X={};M&8&&(X.disabled=y[3]),M&16&&(X.isInvalid=((F=y[4])==null?void 0:F.name)!==void 0),M&16&&(X.helperMessage=(se=(W=y[4])==null?void 0:W.name)==null?void 0:se.message),!a&&M&4&&(a=!0,X.value=y[2].name,ye(()=>a=!1)),s.$set(X);const te={};M&8&&(te.disabled=y[3]),M&16&&(te.isInvalid=(($e=y[4])==null?void 0:$e.sort_index)!==void 0),M&16&&(te.helperMessage=(De=(de=y[4])==null?void 0:de.sort_index)==null?void 0:De.message),!o&&M&4&&(o=!0,te.value=y[2].sort_index,ye(()=>o=!1)),l.$set(te),y[1]==="update"?V?(V.p(y,M),M&2&&_(V,1)):(V=$t(y),V.c(),_(V,1),V.m(t,null)):V&&(ie(),h(V,1,1,()=>{V=null}),ue()),y[1]!=="add"&&y[5]?L?(L.p(y,M),M&34&&_(L,1)):(L=vt(y),L.c(),_(L,1),L.m(c,null)):L&&(ie(),h(L,1,1,()=>{L=null}),ue());const he={};M&8&&(he.disabled=y[3]),M&268435456&&(he.$$scope={dirty:M,ctx:y}),b.$set(he);const v={};M&8&&(v.disabled=y[3]),M&268435466&&(v.$$scope={dirty:M,ctx:y}),$.$set(v)},i(y){j||(_(s.$$.fragment,y),_(l.$$.fragment,y),_(V),_(L),_(b.$$.fragment,y),_($.$$.fragment,y),j=!0)},o(y){h(s.$$.fragment,y),h(l.$$.fragment,y),h(V),h(L),h(b.$$.fragment,y),h($.$$.fragment,y),j=!1},d(y){y&&p(e),N(s),N(l),V&&V.d(),L&&L.d(),N(b),N($),Z=!1,H()}}}function $t(n){var s,a,r,l;let e,t;return e=new Lt({props:{created_at:(s=n[0])==null?void 0:s.created_at,created_by_id:(a=n[0])==null?void 0:a.created_by_id,updated_at:(r=n[0])==null?void 0:r.updated_at,updated_by_id:(l=n[0])==null?void 0:l.updated_by_id}}),{c(){E(e.$$.fragment)},l(o){T(e.$$.fragment,o)},m(o,i){A(e,o,i),t=!0},p(o,i){var d,c,f,m;const u={};i&1&&(u.created_at=(d=o[0])==null?void 0:d.created_at),i&1&&(u.created_by_id=(c=o[0])==null?void 0:c.created_by_id),i&1&&(u.updated_at=(f=o[0])==null?void 0:f.updated_at),i&1&&(u.updated_by_id=(m=o[0])==null?void 0:m.updated_by_id),e.$set(u)},i(o){t||(_(e.$$.fragment,o),t=!0)},o(o){h(e.$$.fragment,o),t=!1},d(o){N(e,o)}}}function vt(n){let e,t;return e=new ke({props:{type:"button",size:"xs",color:"red",disabled:n[3],$$slots:{default:[Ms]},$$scope:{ctx:n}}}),e.$on("click",n[19]),{c(){E(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){A(e,s,a),t=!0},p(s,a){const r={};a&8&&(r.disabled=s[3]),a&268435456&&(r.$$scope={dirty:a,ctx:s}),e.$set(r)},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){h(e.$$.fragment,s),t=!1},d(s){N(e,s)}}}function Ms(n){let e;return{c(){e=Y("Delete")},l(t){e=x(t,"Delete")},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function Os(n){let e;return{c(){e=Y("Reset")},l(t){e=x(t,"Reset")},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function zs(n){let e=n[1]==="add"?"Add":"Update",t;return{c(){t=Y(e)},l(s){t=x(s,e)},m(s,a){C(s,t,a)},p(s,a){a&2&&e!==(e=s[1]==="add"?"Add":"Update")&&Te(t,e)},d(s){s&&p(t)}}}function Bs(n){let e;return{c(){e=Y("...")},l(t){e=x(t,"...")},m(t,s){C(t,e,s)},p:Ae,d(t){t&&p(e)}}}function js(n){let e;function t(r,l){return r[3]?Bs:zs}let s=t(n),a=s(n);return{c(){a.c(),e=be()},l(r){a.l(r),e=be()},m(r,l){a.m(r,l),C(r,e,l)},p(r,l){s===(s=t(r))&&a?a.p(r,l):(a.d(1),a=s(r),a&&(a.c(),a.m(e.parentNode,e)))},d(r){r&&p(e),a.d(r)}}}function Hs(n){let e,t,s=n[2]&&ht(n);return{c(){s&&s.c(),e=be()},l(a){s&&s.l(a),e=be()},m(a,r){s&&s.m(a,r),C(a,e,r),t=!0},p(a,[r]){a[2]?s?(s.p(a,r),r&4&&_(s,1)):(s=ht(a),s.c(),_(s,1),s.m(e.parentNode,e)):s&&(ie(),h(s,1,1,()=>{s=null}),ue())},i(a){t||(_(s),t=!0)},o(a){h(s),t=!1},d(a){a&&p(e),s&&s.d(a)}}}function Ks(n,e,t){let s,a,r,l,o,i,u;const{loading:d,targetRoleGroup:c,model:f,action:m,canDelete:b,addRoleGroup:D,updateRoleGroup:$,deleteRoleGroup:j}=Mt();Q(n,d,w=>t(3,o=w)),Q(n,c,w=>t(0,s=w)),Q(n,f,w=>t(2,r=w)),Q(n,m,w=>t(1,a=w)),Q(n,b,w=>t(5,u=w));const{closeDrawer:Z}=He(),{store:{roleGroups:H}}=Ce,{errors:G,submitted:I,validate:K,reset:J}=Nt(Vt({name:Gt().required("Name is required").label("Name"),sort_index:Ut().required().label("Sort Index")}));Q(n,G,w=>t(4,i=w)),Q(n,I,w=>t(20,l=w));const V=()=>{s&&f.set({name:s.name,sort_index:(s==null?void 0:s.sort_index)??0}),I.set(!1),J()},L=async()=>{if(!l)return;const{name:w,sort_index:y}=r;await K({name:w,sort_index:y})},le=async()=>{try{d.set(!0),I.set(!0);const{name:w,sort_index:y}=r;switch(await K({name:w,sort_index:y}),a){case"add":await D({...s,name:w,sort_index:y}),console.log("### add done");break;case"update":await $({...s,name:w,sort_index:y});break;case"delete":s!=null&&s.id&&await j(s.id);break;default:}await H.reload(),Z()}catch(w){console.log("submit failed",w)}finally{d.set(!1)}};c.subscribe(w=>{w&&f.set({name:w==null?void 0:w.name,sort_index:(w==null?void 0:w.sort_index)??0})});function k(w){oe.call(this,n,w)}function ge(w){n.$$.not_equal(r.name,w)&&(r.name=w,f.set(r))}function P(w){n.$$.not_equal(r.sort_index,w)&&(r.sort_index=w,f.set(r))}return[s,a,r,o,i,u,d,c,f,m,b,G,I,V,L,le,k,ge,P,()=>{m.set("delete"),le()}]}class Qs extends _e{constructor(e){super(),pe(this,e,Ks,Hs,me,{})}}function Zs(n){let e,t,s="Role Group",a,r,l,o,i;return r=new Et({props:{class:"mb-4 dark:text-white"}}),r.$on("click",n[3]),o=new Qs({}),{c(){e=U("div"),t=U("h5"),t.textContent=s,a=z(),E(r.$$.fragment),l=z(),E(o.$$.fragment),this.h()},l(u){e=q(u,"DIV",{class:!0});var d=O(e);t=q(d,"H5",{id:!0,class:!0,"data-svelte-h":!0}),Be(t)!=="svelte-euk447"&&(t.textContent=s),a=B(d),T(r.$$.fragment,d),d.forEach(p),l=B(u),T(o.$$.fragment,u),this.h()},h(){S(t,"id","drawer-label"),S(t,"class","inline-flex items-center mb-6 text-base font-semibold text-gray-500 uppercase dark:text-gray-400"),S(e,"class","flex items-center")},m(u,d){C(u,e,d),R(e,t),R(e,a),A(r,e,null),C(u,l,d),A(o,u,d),i=!0},p:Ae,i(u){i||(_(r.$$.fragment,u),_(o.$$.fragment,u),i=!0)},o(u){h(r.$$.fragment,u),h(o.$$.fragment,u),i=!1},d(u){u&&(p(e),p(l)),N(r),N(o,u)}}}function Js(n){let e,t,s;function a(l){n[4](l)}let r={transitionType:"fly",transitionParams:n[1],id:"role-group-drawer",placement:"right",class:"mt-0",$$slots:{default:[Zs]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.hidden=n[0]),e=new At({props:r}),ve.push(()=>we(e,"hidden",a)),{c(){E(e.$$.fragment)},l(l){T(e.$$.fragment,l)},m(l,o){A(e,l,o),s=!0},p(l,[o]){const i={};o&32&&(i.$$scope={dirty:o,ctx:l}),!t&&o&1&&(t=!0,i.hidden=l[0],ye(()=>t=!1)),e.$set(i)},i(l){s||(_(e.$$.fragment,l),s=!0)},o(l){h(e.$$.fragment,l),s=!1},d(l){N(e,l)}}}function Ws(n,e,t){let s,a={x:320,duration:200,easing:Tt};const{drawerClosed:r,closeDrawer:l}=He();Q(n,r,i=>t(0,s=i));function o(i){s=i,r.set(s)}return[s,a,r,l,o]}class Xs extends _e{constructor(e){super(),pe(this,e,Ws,Js,me,{})}}function yt(n){let e,t,s;return t=new Dt({props:{options:n[1],data:n[3],loading:n[4],$$slots:{header:[xs]},$$scope:{ctx:n}}}),{c(){e=U("div"),E(t.$$.fragment),this.h()},l(a){e=q(a,"DIV",{class:!0});var r=O(e);T(t.$$.fragment,r),r.forEach(p),this.h()},h(){S(e,"class","flex flex-col space-y-3")},m(a,r){C(a,e,r),A(t,e,null),s=!0},p(a,r){const l={};r&2&&(l.options=a[1]),r&8&&(l.data=a[3]),r&16&&(l.loading=a[4]),r&131073&&(l.$$scope={dirty:r,ctx:a}),t.$set(l)},i(a){s||(_(t.$$.fragment,a),s=!0)},o(a){h(t.$$.fragment,a),s=!1},d(a){a&&p(e),N(t)}}}function Ys(n){let e;return{c(){e=Y("Add")},l(t){e=x(t,"Add")},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function xs(n){let e,t,s,a,r,l;return r=new ke({props:{size:"xs",color:"alternative",$$slots:{default:[Ys]},$$scope:{ctx:n}}}),r.$on("click",n[9]),{c(){e=U("div"),t=U("p"),s=Y(n[0]),a=z(),E(r.$$.fragment),this.h()},l(o){e=q(o,"DIV",{slot:!0,class:!0});var i=O(e);t=q(i,"P",{class:!0});var u=O(t);s=x(u,n[0]),u.forEach(p),a=B(i),T(r.$$.fragment,i),i.forEach(p),this.h()},h(){S(t,"class","dark:text-white text-lg"),S(e,"slot","header"),S(e,"class","flex justify-between mb-0 items-center mx-md-5")},m(o,i){C(o,e,i),R(e,t),R(t,s),R(e,a),A(r,e,null),l=!0},p(o,i){(!l||i&1)&&Te(s,o[0]);const u={};i&131072&&(u.$$scope={dirty:i,ctx:o}),r.$set(u)},i(o){l||(_(r.$$.fragment,o),l=!0)},o(o){h(r.$$.fragment,o),l=!1},d(o){o&&p(e),N(r)}}}function en(n){let e,t,s,a=n[1]&&n[2]&&n[2].length>0&&yt(n);return t=new Xs({}),{c(){a&&a.c(),e=z(),E(t.$$.fragment)},l(r){a&&a.l(r),e=B(r),T(t.$$.fragment,r)},m(r,l){a&&a.m(r,l),C(r,e,l),A(t,r,l),s=!0},p(r,[l]){r[1]&&r[2]&&r[2].length>0?a?(a.p(r,l),l&6&&_(a,1)):(a=yt(r),a.c(),_(a,1),a.m(e.parentNode,e)):a&&(ie(),h(a,1,1,()=>{a=null}),ue())},i(r){s||(_(a),_(t.$$.fragment,r),s=!0)},o(r){h(a),h(t.$$.fragment,r),s=!1},d(r){r&&p(e),a&&a.d(r),N(t,r)}}}function tn(n,e,t){let s,a,r,l,{title:o="Role Groups"}=e;const{store:{roleGroups:i}}=Ce;Q(n,i,G=>t(2,a=G));const{openDrawer:u}=He(),{targetRoleGroup:d,action:c}=Mt(),{loading:f}=i;Q(n,f,G=>t(4,l=G));const m={onRowClick:G=>{c.set("update"),u();const I={...G};d.set(I)},columnDefs:[{label:"Name",dataProperty:"name",dataType:Ge.String,viewAlignment:Ue.Left},{label:"Sort Index",dataProperty:"sort_index",dataType:Ge.String,viewAlignment:Ue.Right}]},b=It(m),{store:{options:D,data:$},actions:{setRowData:j}}=b;Q(n,D,G=>t(1,s=G)),Q(n,$,G=>t(3,r=G));const Z=()=>{c.set("add"),d.set({name:"",sort_index:0}),u()},H=i.subscribe(G=>{const I=G.sort(({sort_index:K},{sort_index:J})=>K-J);j(I)});return kt(()=>{H(),Us(),Ps()}),n.$$set=G=>{"title"in G&&t(0,o=G.title)},[o,s,a,r,l,i,f,D,$,Z]}class sn extends _e{constructor(e){super(),pe(this,e,tn,en,me,{title:0})}}function nn(n){let e;return{c(){e=Y(`The navbar component can be used to show a list of navigation links positioned on the top side
		of your page based on multiple layouts, sizes, and dropdowns`)},l(t){e=x(t,`The navbar component can be used to show a list of navigation links positioned on the top side
		of your page based on multiple layouts, sizes, and dropdowns`)},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function rn(n){let e;return{c(){e=Y(`Get started with the responsive navbar component from Flowbite to quickly set up a navigation
		menu for your website and set up the logo, list of pages, CTA button, search input, user profile
		options with a dropdown, and more.`)},l(t){e=x(t,`Get started with the responsive navbar component from Flowbite to quickly set up a navigation
		menu for your website and set up the logo, list of pages, CTA button, search input, user profile
		options with a dropdown, and more.`)},m(t,s){C(t,e,s)},d(t){t&&p(e)}}}function an(n){let e,t;return e=new Vs({}),{c(){E(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){A(e,s,a),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){h(e.$$.fragment,s),t=!1},d(s){N(e,s)}}}function ln(n){let e,t;return e=new sn({}),{c(){E(e.$$.fragment)},l(s){T(e.$$.fragment,s)},m(s,a){A(e,s,a),t=!0},i(s){t||(_(e.$$.fragment,s),t=!0)},o(s){h(e.$$.fragment,s),t=!1},d(s){N(e,s)}}}function on(n){let e,t,s,a;return e=new rt({props:{open:!0,title:"Roles",$$slots:{default:[an]},$$scope:{ctx:n}}}),s=new rt({props:{title:"Groups",$$slots:{default:[ln]},$$scope:{ctx:n}}}),{c(){E(e.$$.fragment),t=z(),E(s.$$.fragment)},l(r){T(e.$$.fragment,r),t=B(r),T(s.$$.fragment,r)},m(r,l){A(e,r,l),C(r,t,l),A(s,r,l),a=!0},p(r,l){const o={};l&1&&(o.$$scope={dirty:l,ctx:r}),e.$set(o);const i={};l&1&&(i.$$scope={dirty:l,ctx:r}),s.$set(i)},i(r){a||(_(e.$$.fragment,r),_(s.$$.fragment,r),a=!0)},o(r){h(e.$$.fragment,r),h(s.$$.fragment,r),a=!1},d(r){r&&p(t),N(e,r),N(s,r)}}}function un(n){let e,t,s="Roles",a,r,l,o,i,u,d,c;return r=new tt({props:{class:"text-lg text-gray-600 dark:text-gray-400",$$slots:{default:[nn]},$$scope:{ctx:n}}}),i=new tt({props:{$$slots:{default:[rn]},$$scope:{ctx:n}}}),d=new ns({props:{style:"underline",contentClass:"py-4 px-0 rounded-lg mt-0",$$slots:{default:[on]},$$scope:{ctx:n}}}),{c(){e=U("div"),t=U("h1"),t.textContent=s,a=z(),E(r.$$.fragment),l=z(),o=U("div"),E(i.$$.fragment),u=z(),E(d.$$.fragment),this.h()},l(f){e=q(f,"DIV",{class:!0});var m=O(e);t=q(m,"H1",{class:!0,"data-svelte-h":!0}),Be(t)!=="svelte-1pq2ohe"&&(t.textContent=s),a=B(m),T(r.$$.fragment,m),m.forEach(p),l=B(f),o=q(f,"DIV",{class:!0});var b=O(o);T(i.$$.fragment,b),b.forEach(p),u=B(f),T(d.$$.fragment,f),this.h()},h(){S(t,"class","text-3xl w-full inline-block mb-2 font-extrabold tracking-tight text-gray-900 dark:text-white"),S(e,"class","pb-8 pt-8"),S(o,"class","pb-8")},m(f,m){C(f,e,m),R(e,t),R(e,a),A(r,e,null),C(f,l,m),C(f,o,m),A(i,o,null),C(f,u,m),A(d,f,m),c=!0},p(f,[m]){const b={};m&1&&(b.$$scope={dirty:m,ctx:f}),r.$set(b);const D={};m&1&&(D.$$scope={dirty:m,ctx:f}),i.$set(D);const $={};m&1&&($.$$scope={dirty:m,ctx:f}),d.$set($)},i(f){c||(_(r.$$.fragment,f),_(i.$$.fragment,f),_(d.$$.fragment,f),c=!0)},o(f){h(r.$$.fragment,f),h(i.$$.fragment,f),h(d.$$.fragment,f),c=!1},d(f){f&&(p(e),p(l),p(o),p(u)),N(r),N(i),N(d,f)}}}class In extends _e{constructor(e){super(),pe(this,e,null,un,me,{})}}export{In as component};
