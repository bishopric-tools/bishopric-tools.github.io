var he=Object.defineProperty;var ge=(a,e,r)=>e in a?he(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r;var Y=(a,e,r)=>(ge(a,typeof e!="symbol"?e+"":e,r),r);import{$ as U,s as H,f as j,l as E,a as N,g as R,h as G,m as I,d as p,c as D,j as A,i as _,x as B,n as O,z as V,e as v,o as be,a1 as ye,Z as we,C as ke}from"../chunks/scheduler.b53f554c.js";import{S as Z,i as J,b,d as y,m as w,a as $,t as h,e as k,g as M,c as q}from"../chunks/index.8dc6213e.js";import{P as ee}from"../chunks/P.e17eb30e.js";import{r as K,e as T,u as L,o as Q}from"../chunks/rbac.state.587bfccc.js";import{C as ve}from"../chunks/Checkbox.99d5b40e.js";import{T as Pe,a as Ce,b as Ne,c as pe,d as De,e as de}from"../chunks/TableHeadCell.9f6e1dbb.js";import{w as Se}from"../chunks/index.adf7635c.js";import{s as z}from"../chunks/client.c0def72b.js";import{a as Te}from"../chunks/auth.state.423078db.js";import{n as xe}from"../chunks/toaster.state.1b746a50.js";class je{constructor(){Y(this,"tableName","role_permissions")}async bulkCreate(e){try{const{data:r,error:t}=await z.from(this.tableName).insert(e).select();return t?(console.error(t),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)):Promise.resolve(r)}catch(r){return console.error(r),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)}}async bulkUpdate(e,r){try{const{data:t,error:s}=await z.from(this.tableName).upsert(e,r).select();return s?(console.error(s),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)):Promise.resolve(t)}catch(t){return console.error(t),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)}}async getAll(){try{const{data:e,error:r}=await z.from(this.tableName).select();return r?(console.error(r),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`)):Promise.resolve(e)}catch(e){return console.error(e),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`)}}async bulkDelete(e){try{const{error:r}=await z.from(this.tableName).delete().in("id",e);return r?(console.error(r),Promise.reject(`Deletion of ${this.tableName} record failed, please try again.`)):Promise.resolve()}catch(r){return console.error(r),Promise.reject(`Deletion of ${this.tableName} record failed, please try again.`)}}}const te=new je,{store:{currentUser:Re}}=Te,{store:{rolePermissions:re}}=K,{action:{toastify:oe}}=xe;let F=null,C=null;const Ae=()=>(C=Se(!1),F={loading:C,upsertRolePermission:async(a,e)=>{C==null||C.set(!0);const r=U(re),t=U(Re),s=r.find(l=>l.permission_id===e&&l.role_id===a);let o="Create";try{if(s){o="Update";const l=[{...s,role_id:a,permission_id:e,updated_by_id:t==null?void 0:t.id,updated_at:new Date().toISOString(),on:!s.on}];await te.bulkUpdate(l,{onConflict:"uuid"})}else{o="Addition";const l=[{role_id:a,permission_id:e,created_by_id:t==null?void 0:t.id,created_at:new Date().toISOString(),updated_by_id:t==null?void 0:t.id,updated_at:new Date().toISOString(),on:!0}];await te.bulkCreate(l)}await re.reload(),oe({type:"success",message:`${o} of role permission successful`})}catch{oe({type:"error",message:`${o} of role permission failed, please refresh browser and try again.`})}finally{C==null||C.set(!1)}}},F),Be=()=>F===null?Ae():F,Ge=()=>{F=null,C=null};function se(a,e,r){const t=a.slice();return t[16]=e[r],t}function le(a,e,r){const t=a.slice();return t[19]=e[r],t}function ne(a,e,r){const t=a.slice();return t[19]=e[r],t}function Ee(a){let e;return{c(){e=E("Permission")},l(r){e=I(r,"Permission")},m(r,t){_(r,e,t)},d(r){r&&p(e)}}}function Ie(a){let e=a[19].name+"",r;return{c(){r=E(e)},l(t){r=I(t,e)},m(t,s){_(t,r,s)},p(t,s){s&4&&e!==(e=t[19].name+"")&&O(r,e)},d(t){t&&p(r)}}}function ae(a,e){let r,t,s;return t=new pe({props:{$$slots:{default:[Ie]},$$scope:{ctx:e}}}),{key:a,first:null,c(){r=v(),b(t.$$.fragment),this.h()},l(o){r=v(),y(t.$$.fragment,o),this.h()},h(){this.first=r},m(o,l){_(o,r,l),w(t,o,l),s=!0},p(o,l){e=o;const n={};l&16777220&&(n.$$scope={dirty:l,ctx:e}),t.$set(n)},i(o){s||($(t.$$.fragment,o),s=!0)},o(o){h(t.$$.fragment,o),s=!1},d(o){o&&p(r),k(t,o)}}}function Ve(a){let e,r,t=[],s=new Map,o,l;e=new pe({props:{$$slots:{default:[Ee]},$$scope:{ctx:a}}});let n=T(a[2]);const c=i=>i[19].name;for(let i=0;i<n.length;i+=1){let f=ne(a,n,i),u=c(f);s.set(u,t[i]=ae(u,f))}return{c(){b(e.$$.fragment),r=N();for(let i=0;i<t.length;i+=1)t[i].c();o=v()},l(i){y(e.$$.fragment,i),r=D(i);for(let f=0;f<t.length;f+=1)t[f].l(i);o=v()},m(i,f){w(e,i,f),_(i,r,f);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(i,f);_(i,o,f),l=!0},p(i,f){const u={};f&16777216&&(u.$$scope={dirty:f,ctx:i}),e.$set(u),f&4&&(n=T(i[2]),M(),t=L(t,f,c,1,i,n,s,o.parentNode,Q,ae,o,ne),q())},i(i){if(!l){$(e.$$.fragment,i);for(let f=0;f<n.length;f+=1)$(t[f]);l=!0}},o(i){h(e.$$.fragment,i);for(let f=0;f<t.length;f+=1)h(t[f]);l=!1},d(i){i&&(p(r),p(o)),k(e,i);for(let f=0;f<t.length;f+=1)t[f].d(i)}}}function Fe(a){let e=a[16].description+"",r;return{c(){r=E(e)},l(t){r=I(t,e)},m(t,s){_(t,r,s)},p(t,s){s&2&&e!==(e=t[16].description+"")&&O(r,e)},d(t){t&&p(r)}}}function Me(a){let e,r;function t(){return a[13](a[19],a[16])}return e=new ve({props:{disabled:a[3],checked:a[9](a[19].id,a[16].id)}}),e.$on("click",t),{c(){b(e.$$.fragment)},l(s){y(e.$$.fragment,s)},m(s,o){w(e,s,o),r=!0},p(s,o){a=s;const l={};o&8&&(l.disabled=a[3]),o&6&&(l.checked=a[9](a[19].id,a[16].id)),e.$set(l)},i(s){r||($(e.$$.fragment,s),r=!0)},o(s){h(e.$$.fragment,s),r=!1},d(s){k(e,s)}}}function ie(a,e){let r,t,s;return t=new de({props:{$$slots:{default:[Me]},$$scope:{ctx:e}}}),{key:a,first:null,c(){r=v(),b(t.$$.fragment),this.h()},l(o){r=v(),y(t.$$.fragment,o),this.h()},h(){this.first=r},m(o,l){_(o,r,l),w(t,o,l),s=!0},p(o,l){e=o;const n={};l&16777230&&(n.$$scope={dirty:l,ctx:e}),t.$set(n)},i(o){s||($(t.$$.fragment,o),s=!0)},o(o){h(t.$$.fragment,o),s=!1},d(o){o&&p(r),k(t,o)}}}function qe(a){let e,r,t=[],s=new Map,o,l;e=new de({props:{$$slots:{default:[Fe]},$$scope:{ctx:a}}});let n=T(a[2]);const c=i=>i[19].name;for(let i=0;i<n.length;i+=1){let f=le(a,n,i),u=c(f);s.set(u,t[i]=ie(u,f))}return{c(){b(e.$$.fragment),r=N();for(let i=0;i<t.length;i+=1)t[i].c();o=N()},l(i){y(e.$$.fragment,i),r=D(i);for(let f=0;f<t.length;f+=1)t[f].l(i);o=D(i)},m(i,f){w(e,i,f),_(i,r,f);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(i,f);_(i,o,f),l=!0},p(i,f){const u={};f&16777218&&(u.$$scope={dirty:f,ctx:i}),e.$set(u),f&782&&(n=T(i[2]),M(),t=L(t,f,c,1,i,n,s,o.parentNode,Q,ie,o,le),q())},i(i){if(!l){$(e.$$.fragment,i);for(let f=0;f<n.length;f+=1)$(t[f]);l=!0}},o(i){h(e.$$.fragment,i);for(let f=0;f<t.length;f+=1)h(t[f]);l=!1},d(i){i&&(p(r),p(o)),k(e,i);for(let f=0;f<t.length;f+=1)t[f].d(i)}}}function ce(a,e){let r,t,s;return t=new De({props:{$$slots:{default:[qe]},$$scope:{ctx:e}}}),{key:a,first:null,c(){r=v(),b(t.$$.fragment),this.h()},l(o){r=v(),y(t.$$.fragment,o),this.h()},h(){this.first=r},m(o,l){_(o,r,l),w(t,o,l),s=!0},p(o,l){e=o;const n={};l&16777230&&(n.$$scope={dirty:l,ctx:e}),t.$set(n)},i(o){s||($(t.$$.fragment,o),s=!0)},o(o){h(t.$$.fragment,o),s=!1},d(o){o&&p(r),k(t,o)}}}function ze(a){let e=[],r=new Map,t,s,o=T(a[1]);const l=n=>n[16].description;for(let n=0;n<o.length;n+=1){let c=se(a,o,n),i=l(c);r.set(i,e[n]=ce(i,c))}return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=v()},l(n){for(let c=0;c<e.length;c+=1)e[c].l(n);t=v()},m(n,c){for(let i=0;i<e.length;i+=1)e[i]&&e[i].m(n,c);_(n,t,c),s=!0},p(n,c){c&782&&(o=T(n[1]),M(),e=L(e,c,l,1,n,o,r,t.parentNode,Q,ce,t,se),q())},i(n){if(!s){for(let c=0;c<o.length;c+=1)$(e[c]);s=!0}},o(n){for(let c=0;c<e.length;c+=1)h(e[c]);s=!1},d(n){n&&p(t);for(let c=0;c<e.length;c+=1)e[c].d(n)}}}function He(a){let e,r,t,s;return e=new Ce({props:{$$slots:{default:[Ve]},$$scope:{ctx:a}}}),t=new Ne({props:{$$slots:{default:[ze]},$$scope:{ctx:a}}}),{c(){b(e.$$.fragment),r=N(),b(t.$$.fragment)},l(o){y(e.$$.fragment,o),r=D(o),y(t.$$.fragment,o)},m(o,l){w(e,o,l),_(o,r,l),w(t,o,l),s=!0},p(o,l){const n={};l&16777220&&(n.$$scope={dirty:l,ctx:o}),e.$set(n);const c={};l&16777230&&(c.$$scope={dirty:l,ctx:o}),t.$set(c)},i(o){s||($(e.$$.fragment,o),$(t.$$.fragment,o),s=!0)},o(o){h(e.$$.fragment,o),h(t.$$.fragment,o),s=!1},d(o){o&&p(r),k(e,o),k(t,o)}}}function Oe(a){let e,r,t,s,o,l;return o=new Pe({props:{$$slots:{default:[He]},$$scope:{ctx:a}}}),{c(){e=j("div"),r=j("p"),t=E(a[0]),s=N(),b(o.$$.fragment),this.h()},l(n){e=R(n,"DIV",{class:!0});var c=G(e);r=R(c,"P",{class:!0});var i=G(r);t=I(i,a[0]),i.forEach(p),s=D(c),y(o.$$.fragment,c),c.forEach(p),this.h()},h(){A(r,"class","dark:text-white text-2xl"),A(e,"class","flex flex-col space-y-3")},m(n,c){_(n,e,c),B(e,r),B(r,t),B(e,s),w(o,e,null),l=!0},p(n,[c]){(!l||c&1)&&O(t,n[0]);const i={};c&16777230&&(i.$$scope={dirty:c,ctx:n}),o.$set(i)},i(n){l||($(o.$$.fragment,n),l=!0)},o(n){h(o.$$.fragment,n),l=!1},d(n){n&&p(e),k(o)}}}function Ze(a,e,r){let t,s,o,l,n,c;const{store:{roles:i,permissions:f,rolePermissions:u}}=K;V(a,i,d=>r(12,n=d)),V(a,f,d=>r(11,l=d)),V(a,u,d=>r(14,o=d));const{loading:m,upsertRolePermission:g}=Be();V(a,m,d=>r(3,c=d));let{title:S}=e,{group_id:x}=e;const W=async(d,P)=>g(d,P),_e=(d,P)=>!!o.find(X=>X.permission_id===P&&X.role_id===d),$e=(d,P)=>W(d.id,P.id);return a.$$set=d=>{"title"in d&&r(0,S=d.title),"group_id"in d&&r(10,x=d.group_id)},a.$$.update=()=>{a.$$.dirty&5120&&r(2,t=x?n.filter(d=>d.group_id===x):[]),a.$$.dirty&2048&&r(1,s=l.sort((d,P)=>!(P!=null&&P.sort_index)||!(d!=null&&d.sort_index)?0:d.sort_index-P.sort_index))},[S,s,t,c,i,f,u,m,W,_e,x,l,n,$e]}class Je extends Z{constructor(e){super(),J(this,e,Ze,Oe,H,{title:0,group_id:10})}}function fe(a,e,r){const t=a.slice();return t[4]=e[r],t}function ue(a){let e,r,t=T(a[0]),s=[];for(let l=0;l<t.length;l+=1)s[l]=me(fe(a,t,l));const o=l=>h(s[l],1,1,()=>{s[l]=null});return{c(){e=j("div");for(let l=0;l<s.length;l+=1)s[l].c();this.h()},l(l){e=R(l,"DIV",{class:!0});var n=G(e);for(let c=0;c<s.length;c+=1)s[c].l(n);n.forEach(p),this.h()},h(){A(e,"class","flex flex-col space-y-8")},m(l,n){_(l,e,n);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);r=!0},p(l,n){if(n&1){t=T(l[0]);let c;for(c=0;c<t.length;c+=1){const i=fe(l,t,c);s[c]?(s[c].p(i,n),$(s[c],1)):(s[c]=me(i),s[c].c(),$(s[c],1),s[c].m(e,null))}for(M(),c=t.length;c<s.length;c+=1)o(c);q()}},i(l){if(!r){for(let n=0;n<t.length;n+=1)$(s[n]);r=!0}},o(l){s=s.filter(Boolean);for(let n=0;n<s.length;n+=1)h(s[n]);r=!1},d(l){l&&p(e),we(s,l)}}}function me(a){let e,r,t,s;return r=new Je({props:{title:a[4].name,group_id:a[4].id}}),{c(){e=j("div"),b(r.$$.fragment),t=N(),this.h()},l(o){e=R(o,"DIV",{class:!0});var l=G(e);y(r.$$.fragment,l),t=D(l),l.forEach(p),this.h()},h(){A(e,"class","flex flex-col space-y-3")},m(o,l){_(o,e,l),w(r,e,null),B(e,t),s=!0},p(o,l){const n={};l&1&&(n.title=o[4].name),l&1&&(n.group_id=o[4].id),r.$set(n)},i(o){s||($(r.$$.fragment,o),s=!0)},o(o){h(r.$$.fragment,o),s=!1},d(o){o&&p(e),k(r)}}}function Ke(a){let e,r,t=a[0]&&a[0].length>0&&ue(a);return{c(){t&&t.c(),e=v()},l(s){t&&t.l(s),e=v()},m(s,o){t&&t.m(s,o),_(s,e,o),r=!0},p(s,[o]){s[0]&&s[0].length>0?t?(t.p(s,o),o&1&&$(t,1)):(t=ue(s),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(M(),h(t,1,1,()=>{t=null}),q())},i(s){r||($(t),r=!0)},o(s){h(t),r=!1},d(s){s&&p(e),t&&t.d(s)}}}function Le(a,e,r){let t,s;const{store:{roleGroups:o,rolePermissions:l}}=K;return V(a,o,n=>r(2,s=n)),be(l.reload),ye(Ge),a.$$.update=()=>{a.$$.dirty&4&&r(0,t=s.sort((n,c)=>!(c!=null&&c.sort_index)||!(n!=null&&n.sort_index)?0:n.sort_index-c.sort_index))},[t,o,s]}class Qe extends Z{constructor(e){super(),J(this,e,Le,Ke,H,{})}}function We(a){let e;return{c(){e=E(`The navbar component can be used to show a list of navigation links positioned on the top side
		of your page based on multiple layouts, sizes, and dropdowns`)},l(r){e=I(r,`The navbar component can be used to show a list of navigation links positioned on the top side
		of your page based on multiple layouts, sizes, and dropdowns`)},m(r,t){_(r,e,t)},d(r){r&&p(e)}}}function Xe(a){let e;return{c(){e=E(`Get started with the responsive navbar component from Flowbite to quickly set up a navigation
		menu for your website and set up the logo, list of pages, CTA button, search input, user profile
		options with a dropdown, and more.`)},l(r){e=I(r,`Get started with the responsive navbar component from Flowbite to quickly set up a navigation
		menu for your website and set up the logo, list of pages, CTA button, search input, user profile
		options with a dropdown, and more.`)},m(r,t){_(r,e,t)},d(r){r&&p(e)}}}function Ye(a){let e,r,t="Role Permissions",s,o,l,n,c,i,f,u;return o=new ee({props:{class:"text-lg text-gray-600 dark:text-gray-400",$$slots:{default:[We]},$$scope:{ctx:a}}}),c=new ee({props:{$$slots:{default:[Xe]},$$scope:{ctx:a}}}),f=new Qe({}),{c(){e=j("div"),r=j("h1"),r.textContent=t,s=N(),b(o.$$.fragment),l=N(),n=j("div"),b(c.$$.fragment),i=N(),b(f.$$.fragment),this.h()},l(m){e=R(m,"DIV",{class:!0});var g=G(e);r=R(g,"H1",{class:!0,"data-svelte-h":!0}),ke(r)!=="svelte-5lt9pb"&&(r.textContent=t),s=D(g),y(o.$$.fragment,g),g.forEach(p),l=D(m),n=R(m,"DIV",{class:!0});var S=G(n);y(c.$$.fragment,S),S.forEach(p),i=D(m),y(f.$$.fragment,m),this.h()},h(){A(r,"class","text-3xl w-full inline-block mb-2 font-extrabold tracking-tight text-gray-900 dark:text-white"),A(e,"class","pb-8 pt-8"),A(n,"class","pb-8")},m(m,g){_(m,e,g),B(e,r),B(e,s),w(o,e,null),_(m,l,g),_(m,n,g),w(c,n,null),_(m,i,g),w(f,m,g),u=!0},p(m,[g]){const S={};g&1&&(S.$$scope={dirty:g,ctx:m}),o.$set(S);const x={};g&1&&(x.$$scope={dirty:g,ctx:m}),c.$set(x)},i(m){u||($(o.$$.fragment,m),$(c.$$.fragment,m),$(f.$$.fragment,m),u=!0)},o(m){h(o.$$.fragment,m),h(c.$$.fragment,m),h(f.$$.fragment,m),u=!1},d(m){m&&(p(e),p(l),p(n),p(i)),k(o),k(c),k(f,m)}}}class ft extends Z{constructor(e){super(),J(this,e,null,Ye,H,{})}}export{ft as component};
