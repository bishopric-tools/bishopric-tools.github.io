var y=Object.defineProperty;var w=(e,r,t)=>r in e?y(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var h=(e,r,t)=>(w(e,typeof r!="symbol"?r+"":r,t),t);import{s as l}from"./client.3f1dd265.js";import{w as f}from"./index.93f5e474.js";function C(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}var i={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.throwTypescriptError=e.throwError=void 0;const r=o=>{throw new Error(`[svelte-preprocess] ${o}`)};e.throwError=r;const t=()=>{(0,e.throwError)("Encountered type error")};e.throwTypescriptError=t})(i);const d=(e,r)=>{const{subscribe:t,set:o}=f(e),a=f(!0),s=async()=>{a.set(!0);const n=await r();o(n),a.set(!1)};return r().then(n=>o(n)).catch(n=>i.throwError(n)).finally(()=>{a.set(!1)}),{subscribe:t,reload:s,reset:()=>o([]),loading:a}};class p{constructor(r){h(this,"tableName");this.tableName=r}async bulkCreate(r){try{const{data:t,error:o}=await l.from(this.tableName).insert(r).select();return o?(console.error(o),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)):Promise.resolve(t)}catch(t){return console.error(t),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)}}async bulkUpdate(r,t){try{const{data:o,error:a}=await l.from(this.tableName).upsert(r,t).select();return a?(console.error(a),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)):Promise.resolve(o)}catch(o){return console.error(o),Promise.reject(`Creation of ${this.tableName} records failed, please try again.`)}}async getAll(){try{const{data:r,error:t}=await l.from(this.tableName).select();return t?(console.error(t),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`)):Promise.resolve(r)}catch(r){return console.error(r),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`)}}async bulkDelete(r){try{const{error:t}=await l.from(this.tableName).delete().in("id",r);return t?(console.error(t),Promise.reject(`Deletion of ${this.tableName} record failed, please try again.`)):Promise.resolve()}catch(t){return console.error(t),Promise.reject(`Deletion of ${this.tableName} record failed, please try again.`)}}}class b extends p{constructor(){super("users")}}const g=new b;class P extends p{constructor(){super("permission_groups")}}const E=new P;class _ extends p{constructor(){super("permissions")}async getAllWithGroupDetails(){try{const{data:r,error:t}=await l.from(this.tableName).select("id, description, permission_groups(id, name)");if(t)return console.error(t),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`);const o=r.map(a=>{var n,u;const s=a;return{id:s.id,description:s.description,groupId:(n=s.permission_groups)==null?void 0:n.id,groupName:(u=s.permission_groups)==null?void 0:u.name}});return Promise.resolve(o)}catch(r){return console.error(r),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`)}}}const A=new _;class N extends p{constructor(){super("roles")}async getAllWithGroupDetails(){try{const{data:r,error:t}=await l.from(this.tableName).select(`
					id, 
					name, 
					sort_index, 
					uuid, 
					created_at, 
					created_by_id, 
					updated_at, 
					updated_by_id, 
					role_groups(id, name)
				`).order("sort_index",{ascending:!0});if(t)return console.error(t),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`);const o=r.map(a=>{var n,u;const s=a;return{id:s.id,name:s.name,sort_index:s.sort_index,group_id:(n=s.role_groups)==null?void 0:n.id,group_name:(u=s.role_groups)==null?void 0:u.name,uuid:s.uuid,created_by_id:s.created_by_id,created_at:s.created_at,updated_by_id:s.updated_by_id,updated_at:s.updated_at}});return Promise.resolve(o)}catch(r){return console.error(r),Promise.reject(`Fetch of ${this.tableName} records failed, please try again.`)}}}const j=new N;class $ extends p{constructor(){super("role_groups")}}const G=new $,v=()=>{const e="Failed to fetch data, please refresh browser and try again",r=d([],async()=>{try{return await g.getAll()}catch{return i.throwError(e)}}),t=d([],async()=>{try{return await E.getAll()}catch{return i.throwError(e)}}),o=d([],async()=>{try{return A.getAllWithGroupDetails()}catch{return i.throwError(e)}}),a=d([],async()=>{try{return G.getAll()}catch{return i.throwError(e)}}),s=d([],async()=>{try{return j.getAllWithGroupDetails()}catch{return i.throwError(e)}}),n=d([],async()=>{try{const{data:c,error:m}=await l.from("role_permissions").select("*");return m?i.throwError(e):c}catch{return i.throwError(e)}}),u=d([],async()=>{try{const{data:c,error:m}=await l.from("user_roles").select("*");return m?i.throwError(e):c}catch{return i.throwError(e)}});return{store:{users:r,permissionGroups:t,permissions:o,roleGroups:a,roles:s,rolePermissions:n,userRoles:u}}},R=v();export{j as a,C as e,R as r,g as u};
